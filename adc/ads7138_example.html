<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ads7138 Example - ESP32 -  &mdash; ESPP main documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=a60756f2" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=949a1ff5" />
      <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css?v=851bd809" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=d01aebe5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=ff8fa330"></script>
    <script src="../_static/js/theme.js"></script>

    
        

    <script type="text/javascript">
        DOCUMENTATION_OPTIONS.PAGENAME = 'adc/ads7138_example';
        DOCUMENTATION_OPTIONS.PROJECT_SLUG = 'esp-cpp';
        DOCUMENTATION_OPTIONS.LATEST_BRANCH_NAME = 'master';
        DOCUMENTATION_OPTIONS.VERSIONS_URL = 'https://dl.espressif.com/dl/esp-idf/idf_versions.js';
        DOCUMENTATION_OPTIONS.LANGUAGES = ["en"];
        DOCUMENTATION_OPTIONS.IDF_TARGET = 'esp32';
        DOCUMENTATION_OPTIONS.HAS_IDF_TARGETS = ["esp32", "esp32s2", "esp32c3"]
        DOCUMENTATION_OPTIONS.RELEASE = 'main';
        DOCUMENTATION_OPTIONS.LANGUAGE_URL = 'en';

    </script>

    <script type="text/javascript" src="https://dl.espressif.com/dl/esp-idf/idf_versions.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Oneshot ADC" href="oneshot_adc.html" />
    <link rel="prev" title="ADS7138 I2C ADC" href="ads7138.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            ESPP
              <img src="../_static/espressif-logo.svg" class="logo" alt="Logo"/>
          </a>

          
            <div class="selectors">
              <select id="target-select" style="width: 150px;" hidden>
                <option value="" disabled selected>Choose target...</option>
              </select>
            </div>
          

          <div class="selectors">
            <select id="version-select" style="width: 150px;" hidden>
              <option value="" disabled selected>Choose version...</option>
            </select>
          </div>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ADC APIs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ads1x15.html">ADS1x15 I2C ADC</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="ads7138.html">ADS7138 I2C ADC</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Ads7138 Example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#how-to-use-example">How to use example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-output">Example Output</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ads7138.html#api-reference">API Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="oneshot_adc.html">Oneshot ADC</a></li>
<li class="toctree-l2"><a class="reference internal" href="continuous_adc.html">Continuous ADC</a></li>
<li class="toctree-l2"><a class="reference internal" href="tla2528.html">TLA2528 I2C ADC</a></li>
<li class="toctree-l2"><a class="reference internal" href="adc_types.html">ADC Types</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../base_component.html">Base Component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../base_peripheral.html">Base Peripheral</a></li>
<li class="toctree-l1"><a class="reference internal" href="../battery/index.html">Battery APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bldc/index.html">BLDC APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble/index.html">BLE APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../button.html">Button APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../byte90.html">ALXV Labs Byte90</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controller.html">Controller APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">Command Line Interface (CLI) APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cobs.html">COBS (Consistent Overhead Byte Stuffing)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../color.html">Color APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../csv.html">CSV APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../display/index.html">Display APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../distance_sensors/index.html">Distance Sensor APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../encoder/index.html">Encoder APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../esp32_timer_cam.html">ESP32 TimerCam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../esp_box.html">ESP BOX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../event_manager.html">Event Manager APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../file_system.html">File System APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filters/index.html">Filter APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ftp/index.html">FTP APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../haptics/index.html">Haptics APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hid/index.html">HID APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../i2c.html">I2C</a></li>
<li class="toctree-l1"><a class="reference internal" href="../imu/index.html">IMU APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interrupt.html">Interrupt APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html">Input APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io_expander/index.html">IO Expander APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../iperf_menu.html">Iperf Menu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../joystick.html">Joystick APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../led.html">LED APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../led_driver/index.html">LED Driver Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../led_strip.html">LED Strip APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logger.html">Logging APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../m5stack_tab5.html">M5Stack Tab5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/index.html">Math APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../matouch_rotary_display.html">MaTouch Rotary Display</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monitor.html">Monitoring APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../motorgo_mini.html">MotorGo Mini</a></li>
<li class="toctree-l1"><a class="reference internal" href="../neopixel.html">Neopixel APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/index.html">Network APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nfc/index.html">NFC APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nvs.html">NVS APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../odrive_ascii.html">ODrive ASCII Protocol Component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pid.html">PID APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../power/index.html">Power Monitoring APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../qtpy.html">QtPy ESP32 Pico and QtPy ESP32-S3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../qwiicnes.html">QwiicNES</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rmt.html">Remote Control Transceiver (RMT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rtc/index.html">RTC APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rtsp.html">RTSP APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../runqueue.html">RunQueue APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../seeed_studio_round_display.html">Seeed Studio Round Display</a></li>
<li class="toctree-l1"><a class="reference internal" href="../serialization.html">Serialization APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../state_machine.html">State Machine APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t_deck.html">LilyGo T-Deck</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t_dongle_s3.html">LilyGo T-Dongle S3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tabulate.html">Tabulate APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../task.html">Task APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thermistor.html">Thermistor APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../timer.html">Timer APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wifi/index.html">WiFi APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wrover_kit.html">ESP32-WROVER-KIT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ws_s3_geek.html">Waveshare ESP32-S3 GEEK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ws_s3_lcd_1_47.html">Waveshare ESP32-S3 LCD 1.47”</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ws_s3_touch.html">Waveshare ESP32-S3 TouchLCD</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ESPP</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">ADC APIs</a></li>
          <li class="breadcrumb-item"><a href="ads7138.html">ADS7138 I2C ADC</a></li>
      <li class="breadcrumb-item active">Ads7138 Example</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/esp-cpp/espp/blob/46e6bf33/docs/en/adc/ads7138_example.md" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ads7138-example">
<h1>Ads7138 Example<a class="headerlink" href="#ads7138-example" title="Permalink to this heading"></a></h1>
<p>This example shows the use of the <code class="docutils literal notranslate"><span class="pre">Ads7138</span></code> component to communicate with an
ADS7138 I2C analog to digital converter using the I2C peripheral of the ESP32.</p>
<p>It uses the <code class="docutils literal notranslate"><span class="pre">task</span></code> component to periodically read two channels of analog data
and one channel of digital input from the ADS7138, set one channel of digital
output, and print the data in CSV format using the <code class="docutils literal notranslate"><span class="pre">format</span></code> component.</p>
<p>This example is designed to be run on a QtPy ESP32S3, with the BP-ADS7128
boosterpack plugged in. We connect the I2C pins on the QtPy Qwiic header (3.3V,
GPIO41 SDA and GPIO40 SCL, and GND) to J1 of the BP-ADS7128: 3.3V (pin 1), SCL
(pin 9), SDA (pin 10), and GND (pin 22). We also connect the 5V pin on the QtPy
header to the 5V pin on the BP-ADS7128 (pin 21 of J1). We then run this example,
and we should see the raw ADC values printed to the console. Finally we connect
a jumper wire between the ALERT pin of the BP-ADS7128 (pin 13 of J3) and the A0
pin of the QtPy (GPIO18). We should see the ALERT pin go low when the joystick
button is pressed. We use a GPIO interrupt handler + task to detect the falling
edge of the ALERT pin, and print a message to the console.</p>
<p>Table of connections between QtPy and BP-ADS7128:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>QtPy</p></th>
<th class="head text-left"><p>BP-ADS7138</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>3.3V (Qwiic)</p></td>
<td class="text-left"><p>3.3V (J1 pin 1)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>GND (Qwiic)</p></td>
<td class="text-left"><p>GND (J1 pin 22)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>I2C SDA (Qwiic)</p></td>
<td class="text-left"><p>SDA (J1 pin 10)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>I2C SCL (Qwiic)</p></td>
<td class="text-left"><p>SCL (J1 pin 9)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>5V</p></td>
<td class="text-left"><p>5V (J1 pin 21)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>A0 (GPIO18)</p></td>
<td class="text-left"><p>ALERT (J3 pin 13)</p></td>
</tr>
</tbody>
</table>
<p>Connected to the BP-ADS7128, we have a Adafruit Thumb Joystick. The X axis
of the joystick is connected to channel 1 of the BP-ADS7128, and the Y axis
of the joystick is connected to channel 3 of the BP-ADS7128. The joystick
also has a button, which is connected to channel 5 of the BP-ADS7128. We
should see the raw ADC values of the joystick printed to the console, and
when we press the button on the joystick, we should see the digital value
change from 1 to 0.</p>
<p>Table of connections between BP-ADS7128 and Adafruit Thumb Joystick:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head text-left"><p>BP-ADS7128</p></th>
<th class="head text-left"><p>Joystick</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>CH1 (J5 pin 2)</p></td>
<td class="text-left"><p>X axis (Xout)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>GND (J5 pin 4)</p></td>
<td class="text-left"><p>GND</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>CH3 (J5 pin 6)</p></td>
<td class="text-left"><p>Y axis (Yout)</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>CH5 (J5 pin 8)</p></td>
<td class="text-left"><p>Button (Sel)</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>3.3V (J1 pin 1)</p></td>
<td class="text-left"><p>VCC</p></td>
</tr>
</tbody>
</table>
<p>NOTE: The analog inputs on J5 of the BP-ADS7128 are connected via a 10k
resistor in series to the actual analog input of the ADS7128. This is to
protect the ADS7128 from overvoltage. Therefore you may want to add a pull-up
resistor to the digital input (Sel) of the joystick, so that when the button
is not pressed, the digital input is pulled high. Otherwise, the digital
input will be floating, and the ADS7128 will read a random value.</p>
<p>On the BP-ADS7128, we also have an LED connected to channel 7. This LED is
active low, so when we set the digital output to 1, the LED should turn off,
and when we set the digital output to 0, the LED should turn on. We can
change the digital output value by pressing the button on the joystick.</p>
<p><img alt="image" src="https://github.com/esp-cpp/espp/assets/213467/844ceebf-81aa-4e8a-8fb4-4e4f6f7d12a8" /></p>
<section id="how-to-use-example">
<h2>How to use example<a class="headerlink" href="#how-to-use-example" title="Permalink to this heading"></a></h2>
<section id="hardware-required">
<h3>Hardware Required<a class="headerlink" href="#hardware-required" title="Permalink to this heading"></a></h3>
<p>To run this example, you need:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.adafruit.com/product/5426">QtPy ESP32S3</a></p></li>
<li><p><a class="reference external" href="https://www.ti.com/tool/BP-ADS7128">BP-ADS7128</a></p></li>
<li><p><a class="reference external" href="https://www.adafruit.com/product/512">Adafruit Thumb Joystick</a></p></li>
<li><p>1 kOhm resistor (between Joystick Select and 3.3V)</p></li>
<li><p>Some dupont wires</p></li>
<li><p>QwiiC cable (JST-SH to Dupont)</p></li>
</ul>
</section>
<section id="build-and-flash">
<h3>Build and Flash<a class="headerlink" href="#build-and-flash" title="Permalink to this heading"></a></h3>
<p>Build the project and flash it to the board, then run monitor tool to view serial output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">idf</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">p</span> <span class="n">PORT</span> <span class="n">flash</span> <span class="n">monitor</span>
</pre></div>
</div>
<p>(Replace PORT with the name of the serial port to use.)</p>
<p>(To exit the serial monitor, type <code class="docutils literal notranslate"><span class="pre">Ctrl-]</span></code>.)</p>
<p>See the Getting Started Guide for full steps to configure and use ESP-IDF to build projects.</p>
</section>
</section>
<section id="example-output">
<h2>Example Output<a class="headerlink" href="#example-output" title="Permalink to this heading"></a></h2>
<p><img alt="CleanShot 2023-06-07 at 11 54 43" src="https://github.com/esp-cpp/espp/assets/213467/49d3b569-e5cd-4575-be27-3f20e8031f3b" />
<img alt="CleanShot 2023-06-06 at 13 46 56" src="https://github.com/esp-cpp/espp/assets/213467/cf68a4d9-4f71-4751-b00e-1ebdadcd3e88" />
<img alt="CleanShot 2023-06-06 at 13 51 55" src="https://github.com/esp-cpp/espp/assets/213467/e1149279-00c2-42d3-a530-f6005c35e69c" /></p>
<section id="example-videos">
<h3>Example videos<a class="headerlink" href="#example-videos" title="Permalink to this heading"></a></h3>
<p>https://github.com/esp-cpp/espp/assets/213467/f1c5e0df-35ca-4c15-b8cb-d1455f7dbd67</p>
<p>https://github.com/esp-cpp/espp/assets/213467/6c56c2cf-8789-4452-beca-ffdaf68f13cb</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ads7138.html" class="btn btn-neutral float-left" title="ADS7138 I2C ADC" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="oneshot_adc.html" class="btn btn-neutral float-right" title="Oneshot ADC" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022 - 2025, William Emfinger.</p>
  </div>

  <ul class="footer">
        <li>
	    
            
            Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/espressif/sphinx_idf_theme">theme</a>  based on <a href="https://github.com/readthedocs/sphinx_rtd_theme">Read the Docs Sphinx Theme</a>.
         </li>

  </ul> 

</footer>
        </div>
      </div>
    </section>
  </div>

  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>