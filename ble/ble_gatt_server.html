<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BLE GATT Server - ESP32 -  &mdash; ESPP main documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=a60756f2" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=949a1ff5" />
      <link rel="stylesheet" type="text/css" href="../_static/theme_overrides.css?v=851bd809" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=d01aebe5"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=ff8fa330"></script>
    <script src="../_static/js/theme.js"></script>

    
        

    <script type="text/javascript">
        DOCUMENTATION_OPTIONS.PAGENAME = 'ble/ble_gatt_server';
        DOCUMENTATION_OPTIONS.PROJECT_SLUG = 'esp-cpp';
        DOCUMENTATION_OPTIONS.LATEST_BRANCH_NAME = 'master';
        DOCUMENTATION_OPTIONS.VERSIONS_URL = 'https://dl.espressif.com/dl/esp-idf/idf_versions.js';
        DOCUMENTATION_OPTIONS.LANGUAGES = ["en"];
        DOCUMENTATION_OPTIONS.IDF_TARGET = 'esp32';
        DOCUMENTATION_OPTIONS.HAS_IDF_TARGETS = ["esp32", "esp32s2", "esp32c3"]
        DOCUMENTATION_OPTIONS.RELEASE = 'main';
        DOCUMENTATION_OPTIONS.LANGUAGE_URL = 'en';

    </script>

    <script type="text/javascript" src="https://dl.espressif.com/dl/esp-idf/idf_versions.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="BLE GATT Server Example" href="ble_gatt_server_example.html" />
    <link rel="prev" title="Battery Service" href="battery_service.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            ESPP
              <img src="../_static/espressif-logo.svg" class="logo" alt="Logo"/>
          </a>

          
            <div class="selectors">
              <select id="target-select" style="width: 150px;" hidden>
                <option value="" disabled selected>Choose target...</option>
              </select>
            </div>
          

          <div class="selectors">
            <select id="version-select" style="width: 150px;" hidden>
              <option value="" disabled selected>Choose version...</option>
            </select>
          </div>

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../adc/index.html">ADC APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../base_component.html">Base Component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../base_peripheral.html">Base Peripheral</a></li>
<li class="toctree-l1"><a class="reference internal" href="../battery/index.html">Battery APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bldc/index.html">BLDC APIs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">BLE APIs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="battery_service.html">Battery Service</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">BLE GATT Server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ble_gatt_server_example.html">BLE GATT Server Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api-reference">API Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#header-file">Header File</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">Header File</a></li>
<li class="toctree-l4"><a class="reference internal" href="#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Header File</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">Header File</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">Classes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ble_gatt_server_example.html">BLE GATT Server Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="device_info_service.html">Device Info Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="generic_access_service.html">Generic Access Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="gfps_service.html">Google Fast Pair Service (GFPS) Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="gfps_service_example.html">Google Fast Pair Service (GFPS) Service Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="hid_service.html">HID Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="hid_service_example.html">BLE HID Service Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../button.html">Button APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../byte90.html">ALXV Labs Byte90</a></li>
<li class="toctree-l1"><a class="reference internal" href="../controller.html">Controller APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">Command Line Interface (CLI) APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cobs.html">COBS (Consistent Overhead Byte Stuffing)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../color.html">Color APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../csv.html">CSV APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../display/index.html">Display APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../distance_sensors/index.html">Distance Sensor APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../encoder/index.html">Encoder APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../esp32_timer_cam.html">ESP32 TimerCam</a></li>
<li class="toctree-l1"><a class="reference internal" href="../esp_box.html">ESP BOX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../event_manager.html">Event Manager APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../file_system.html">File System APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filters/index.html">Filter APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ftp/index.html">FTP APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../haptics/index.html">Haptics APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hid/index.html">HID APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../i2c.html">I2C</a></li>
<li class="toctree-l1"><a class="reference internal" href="../imu/index.html">IMU APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interrupt.html">Interrupt APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html">Input APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io_expander/index.html">IO Expander APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../iperf_menu.html">Iperf Menu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../joystick.html">Joystick APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../led.html">LED APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../led_driver/index.html">LED Driver Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../led_strip.html">LED Strip APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logger.html">Logging APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../m5stack_tab5.html">M5Stack Tab5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/index.html">Math APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../matouch_rotary_display.html">MaTouch Rotary Display</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monitor.html">Monitoring APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../motorgo_mini.html">MotorGo Mini</a></li>
<li class="toctree-l1"><a class="reference internal" href="../neopixel.html">Neopixel APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/index.html">Network APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nfc/index.html">NFC APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nvs.html">NVS APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../odrive_ascii.html">ODrive ASCII Protocol Component</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pid.html">PID APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../power/index.html">Power Monitoring APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../qtpy.html">QtPy ESP32 Pico and QtPy ESP32-S3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../qwiicnes.html">QwiicNES</a></li>
<li class="toctree-l1"><a class="reference internal" href="../remote_debug.html">Remote Debug APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rmt.html">Remote Control Transceiver (RMT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rtc/index.html">RTC APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rtsp.html">RTSP APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../runqueue.html">RunQueue APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../seeed_studio_round_display.html">Seeed Studio Round Display</a></li>
<li class="toctree-l1"><a class="reference internal" href="../serialization.html">Serialization APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../state_machine.html">State Machine APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t_deck.html">LilyGo T-Deck</a></li>
<li class="toctree-l1"><a class="reference internal" href="../t_dongle_s3.html">LilyGo T-Dongle S3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tabulate.html">Tabulate APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../task.html">Task APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thermistor.html">Thermistor APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../timer.html">Timer APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wifi/index.html">WiFi APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wrover_kit.html">ESP32-WROVER-KIT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ws_s3_geek.html">Waveshare ESP32-S3 GEEK</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ws_s3_lcd_1_47.html">Waveshare ESP32-S3 LCD 1.47”</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ws_s3_touch.html">Waveshare ESP32-S3 TouchLCD</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ESPP</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">BLE APIs</a></li>
      <li class="breadcrumb-item active">BLE GATT Server</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/esp-cpp/espp/blob/32e8215e/docs/en/ble/ble_gatt_server.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="ble-gatt-server">
<h1>BLE GATT Server<a class="headerlink" href="#ble-gatt-server" title="Permalink to this heading"></a></h1>
<p>The <cite>BleGattServer</cite> implements the standard BLE GATT server which has various
APIs for controlling the server and adding services. It automatically builds and
adds standard battery service and device information service.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="ble_gatt_server_example.html">BLE GATT Server Example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ble_gatt_server_example.html#how-to-use-example">How to use example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="ble_gatt_server_example.html#hardware-required">Hardware Required</a></li>
<li class="toctree-l3"><a class="reference internal" href="ble_gatt_server_example.html#build-and-flash">Build and Flash</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ble_gatt_server_example.html#example-output">Example Output</a></li>
</ul>
</li>
</ul>
</div>
<section id="api-reference">
<h2>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this heading"></a></h2>
<section id="header-file">
<h3>Header File<a class="headerlink" href="#header-file" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/esp-cpp/espp/blob/32e8215e/components/ble_gatt_server/include/ble_appearances.hpp">components/ble_gatt_server/include/ble_appearances.hpp</a></p></li>
</ul>
</section>
<section id="id1">
<h3>Header File<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/esp-cpp/espp/blob/32e8215e/components/ble_gatt_server/include/ble_gatt_server.hpp">components/ble_gatt_server/include/ble_gatt_server.hpp</a></p></li>
</ul>
</section>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this heading"></a></h3>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServerE">
<span id="_CPPv3N4espp13BleGattServerE"></span><span id="_CPPv2N4espp13BleGattServerE"></span><span id="espp::BleGattServer"></span><span class="target" id="classespp_1_1BleGattServer"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BleGattServer</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">espp</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="../base_component.html#_CPPv4N4espp13BaseComponentE" title="espp::BaseComponent"><span class="n"><span class="pre">BaseComponent</span></span></a><a class="headerlink" href="#_CPPv4N4espp13BleGattServerE" title="Permalink to this definition"></a><br /></dt>
<dd><p>BLE GATT Server This class is responsible for creating and managing the BLE GATT server. It is responsible for handling the connection and disconnection of clients. It is also responsible for handling the pairing process. It also manages the different services that are part of the GATT server.</p>
<section id="classespp_1_1BleGattServer_1ble_gatt_server_ex1">
<h4>BLE GATT Server Example<a class="headerlink" href="#classespp_1_1BleGattServer_1ble_gatt_server_ex1" title="Permalink to this heading"></a></h4>
<div class="highlight-cpp notranslate" id="classespp_1_1BleGattServer_1ble_gatt_server_ex1"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1">// NOTE: esp-nimble-cpp already depends on nvs_flash and initializes</span>
<span class="w">    </span><span class="c1">//       nvs_flash in the NimBLEDevice::init(), so we don&#39;t have to do that</span>
<span class="w">    </span><span class="c1">//       to store bonding info</span>

<span class="w">    </span><span class="c1">// create the GATT server</span>
<span class="w">    </span><span class="n">espp</span><span class="o">::</span><span class="n">BleGattServer</span><span class="w"> </span><span class="n">ble_gatt_server</span><span class="p">;</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">device_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Espp BLE GATT Server&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">set_log_level</span><span class="p">(</span><span class="n">espp</span><span class="o">::</span><span class="n">Logger</span><span class="o">::</span><span class="n">Verbosity</span><span class="o">::</span><span class="n">INFO</span><span class="p">);</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">set_callbacks</span><span class="p">({</span>
<span class="w">        </span><span class="p">.</span><span class="n">connect_callback</span><span class="w"> </span><span class="o">=</span>
<span class="w">            </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="n">NimBLEConnInfo</span><span class="w"> </span><span class="o">&amp;</span><span class="n">conn_info</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Device connected&quot;</span><span class="p">);</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="p">.</span><span class="n">disconnect_callback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">conn_info</span><span class="p">,</span>
<span class="w">                                   </span><span class="k">auto</span><span class="w"> </span><span class="n">reason</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Device disconnected: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">reason</span><span class="p">);</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="p">.</span><span class="n">authentication_complete_callback</span><span class="w"> </span><span class="o">=</span>
<span class="w">            </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="n">NimBLEConnInfo</span><span class="w"> </span><span class="o">&amp;</span><span class="n">conn_info</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Device authenticated&quot;</span><span class="p">);</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="c1">// NOTE: this is optional, if you don&#39;t provide this callback, it will</span>
<span class="w">        </span><span class="c1">// perform the exactly function as below:</span>
<span class="w">        </span><span class="p">.</span><span class="n">get_passkey_callback</span><span class="w"> </span><span class="o">=</span>
<span class="w">            </span><span class="p">[</span><span class="o">&amp;</span><span class="p">]()</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Getting passkey&quot;</span><span class="p">);</span>
<span class="w">              </span><span class="k">return</span><span class="w"> </span><span class="n">NimBLEDevice</span><span class="o">::</span><span class="n">getSecurityPasskey</span><span class="p">();</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="c1">// NOTE: this is optional, if you don&#39;t provide this callback, it will</span>
<span class="w">        </span><span class="c1">// perform the exactly function as below:</span>
<span class="w">        </span><span class="p">.</span><span class="n">confirm_passkey_callback</span><span class="w"> </span><span class="o">=</span>
<span class="w">            </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="n">NimBLEConnInfo</span><span class="w"> </span><span class="o">&amp;</span><span class="n">conn_info</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">passkey</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Confirming passkey: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">passkey</span><span class="p">);</span>
<span class="w">              </span><span class="n">NimBLEDevice</span><span class="o">::</span><span class="n">injectConfirmPasskey</span><span class="p">(</span><span class="n">conn_info</span><span class="p">,</span>
<span class="w">                                                 </span><span class="n">passkey</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NimBLEDevice</span><span class="o">::</span><span class="n">getSecurityPasskey</span><span class="p">());</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">device_name</span><span class="p">);</span>
<span class="cp">#if !CONFIG_BT_NIMBLE_EXT_ADV</span>
<span class="w">    </span><span class="c1">// extended advertisement does not support automatically advertising on</span>
<span class="w">    </span><span class="c1">// disconnect</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">set_advertise_on_disconnect</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
<span class="cp">#endif</span>

<span class="w">    </span><span class="c1">// let&#39;s configure the security</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">bonding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">mitm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">secure_connections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">set_security</span><span class="p">(</span><span class="n">bonding</span><span class="p">,</span><span class="w"> </span><span class="n">mitm</span><span class="p">,</span><span class="w"> </span><span class="n">secure_connections</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// and some i/o and key config</span>
<span class="w">    </span><span class="n">NimBLEDevice</span><span class="o">::</span><span class="n">setSecurityPasskey</span><span class="p">(</span><span class="mi">123456</span><span class="p">);</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">set_io_capabilities</span><span class="p">(</span><span class="n">BLE_HS_IO_NO_INPUT_OUTPUT</span><span class="p">);</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">set_init_key_distribution</span><span class="p">(</span><span class="n">BLE_SM_PAIR_KEY_DIST_ENC</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">BLE_SM_PAIR_KEY_DIST_ID</span><span class="p">);</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">set_resp_key_distribution</span><span class="p">(</span><span class="n">BLE_SM_PAIR_KEY_DIST_ENC</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">BLE_SM_PAIR_KEY_DIST_ID</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// you can create a service and add it to the server using</span>
<span class="w">    </span><span class="c1">// ble_gatt_server.server().addService()</span>

<span class="w">    </span><span class="c1">// now start the services</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">start_services</span><span class="p">();</span><span class="w"> </span><span class="c1">// starts the device info service and battery service</span>
<span class="w">    </span><span class="c1">// NOTE: we could also directly start them ourselves if we wanted to</span>
<span class="w">    </span><span class="c1">//      control the order of starting the services</span>
<span class="w">    </span><span class="c1">// e.g.:</span>
<span class="w">    </span><span class="c1">// ble_gatt_server.battery_service().start();</span>
<span class="w">    </span><span class="c1">// ble_gatt_server.device_info_service().start();</span>

<span class="w">    </span><span class="c1">// now start the gatt server</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">start</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// let&#39;s set some of the service data</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">battery_service</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">battery_service</span><span class="p">();</span>
<span class="w">    </span><span class="n">battery_service</span><span class="p">.</span><span class="n">set_battery_level</span><span class="p">(</span><span class="mi">99</span><span class="p">);</span>

<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">device_info_service</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">device_info_service</span><span class="p">();</span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">vendor_source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x01</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">vid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xCafe</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xFace</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">product_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0100</span><span class="p">;</span>
<span class="w">    </span><span class="n">device_info_service</span><span class="p">.</span><span class="n">set_pnp_id</span><span class="p">(</span><span class="n">vendor_source</span><span class="p">,</span><span class="w"> </span><span class="n">vid</span><span class="p">,</span><span class="w"> </span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">product_version</span><span class="p">);</span>
<span class="w">    </span><span class="n">device_info_service</span><span class="p">.</span><span class="n">set_manufacturer_name</span><span class="p">(</span><span class="s">&quot;ESP-CPP&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">device_info_service</span><span class="p">.</span><span class="n">set_model_number</span><span class="p">(</span><span class="s">&quot;esp-ble-01&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">device_info_service</span><span class="p">.</span><span class="n">set_serial_number</span><span class="p">(</span><span class="s">&quot;1234567890&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">device_info_service</span><span class="p">.</span><span class="n">set_software_version</span><span class="p">(</span><span class="s">&quot;1.0.0&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">device_info_service</span><span class="p">.</span><span class="n">set_firmware_version</span><span class="p">(</span><span class="s">&quot;1.0.0&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">device_info_service</span><span class="p">.</span><span class="n">set_hardware_version</span><span class="p">(</span><span class="s">&quot;1.0.0&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// set the advertising data</span>
<span class="w">    </span><span class="n">espp</span><span class="o">::</span><span class="n">BleGattServer</span><span class="o">::</span><span class="n">AdvertisedData</span><span class="w"> </span><span class="n">adv_data</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// uint8_t flags = BLE_HS_ADV_F_DISC_LTD;</span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BLE_HS_ADV_F_DISC_GEN</span><span class="p">;</span>
<span class="w">    </span><span class="n">adv_data</span><span class="p">.</span><span class="n">setFlags</span><span class="p">(</span><span class="n">flags</span><span class="p">);</span>
<span class="w">    </span><span class="n">adv_data</span><span class="p">.</span><span class="n">setName</span><span class="p">(</span><span class="n">device_name</span><span class="p">);</span>
<span class="w">    </span><span class="n">adv_data</span><span class="p">.</span><span class="n">setAppearance</span><span class="p">((</span><span class="kt">uint16_t</span><span class="p">)</span><span class="n">espp</span><span class="o">::</span><span class="n">BleAppearance</span><span class="o">::</span><span class="n">GENERIC_COMPUTER</span><span class="p">);</span>
<span class="w">    </span><span class="n">adv_data</span><span class="p">.</span><span class="n">addTxPower</span><span class="p">();</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">set_advertisement_data</span><span class="p">(</span><span class="n">adv_data</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// let&#39;s test and use the BLE menu (CLI)</span>
<span class="w">    </span><span class="c1">// turn off some of the logs so that it doesn&#39;t clutter up the CLI</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">set_log_level</span><span class="p">(</span><span class="n">espp</span><span class="o">::</span><span class="n">Logger</span><span class="o">::</span><span class="n">Verbosity</span><span class="o">::</span><span class="n">WARN</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// and make the CLI</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">ble_menu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">espp</span><span class="o">::</span><span class="n">BleGattServerMenu</span><span class="p">(</span><span class="n">ble_gatt_server</span><span class="p">);</span>
<span class="w">    </span><span class="n">cli</span><span class="o">::</span><span class="n">SetColor</span><span class="p">();</span>
<span class="w">    </span><span class="n">cli</span><span class="o">::</span><span class="n">Cli</span><span class="w"> </span><span class="nf">cli</span><span class="p">(</span><span class="n">ble_menu</span><span class="p">.</span><span class="n">get</span><span class="p">());</span>
<span class="w">    </span><span class="n">cli</span><span class="p">.</span><span class="n">ExitAction</span><span class="p">([](</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Goodbye and thanks for all the fish.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">});</span>

<span class="w">    </span><span class="n">espp</span><span class="o">::</span><span class="n">Cli</span><span class="w"> </span><span class="nf">input</span><span class="p">(</span><span class="n">cli</span><span class="p">);</span>
<span class="w">    </span><span class="n">input</span><span class="p">.</span><span class="n">SetInputHistorySize</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="w">    </span><span class="n">input</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span><span class="w"> </span><span class="c1">// this will not return until the user enters the `exit` command.</span>

<span class="w">    </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Menu has finished, starting advertising&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// The menu has finished, so let&#39;s go into a loop to keep the device running</span>
<span class="w">    </span><span class="c1">// now lets start advertising</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">start_advertising</span><span class="p">();</span>

<span class="w">    </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Waiting for connection...&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// now lets update the battery level every second for a little while</span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">battery_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">99</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">was_connected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">can_exit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">num_seconds_to_wait</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">loop_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">steady_clock</span><span class="o">::</span><span class="n">now</span><span class="p">();</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">steady_clock</span><span class="o">::</span><span class="n">now</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// if we are now connected, but were not, then get the services</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">is_connected</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">was_connected</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">connected_device_infos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">get_connected_device_infos</span><span class="p">();</span>
<span class="w">        </span><span class="c1">// check to make sure the first connection has bonded at least.</span>
<span class="w">        </span><span class="c1">//</span>
<span class="w">        </span><span class="c1">// NOTE: if we are not bonded, then the name that will be read out will be</span>
<span class="w">        </span><span class="c1">// generic, such as &quot;iPhone&quot;. If we are bonded, then the name will be the</span>
<span class="w">        </span><span class="c1">// actual device name, such as &quot;iPhone 14 Plus William&quot;.</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">first_device</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">connected_device_infos</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">first_device</span><span class="p">.</span><span class="n">isBonded</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="c1">// if it was, mark connected and print all the device infos</span>
<span class="w">          </span><span class="n">was_connected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">          </span><span class="n">can_exit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">          </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Connected devices: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">connected_device_infos</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
<span class="w">          </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">info</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">connected_device_infos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">auto</span><span class="w"> </span><span class="n">rssi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">get_connected_device_rssi</span><span class="p">(</span><span class="n">info</span><span class="p">);</span>
<span class="w">            </span><span class="k">auto</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">get_connected_device_name</span><span class="p">(</span><span class="n">info</span><span class="p">);</span>
<span class="w">            </span><span class="k">auto</span><span class="w"> </span><span class="n">mfg_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">get_connected_device_manufacturer_name</span><span class="p">(</span><span class="n">info</span><span class="p">);</span>
<span class="w">            </span><span class="k">auto</span><span class="w"> </span><span class="n">model_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">get_connected_device_model_number</span><span class="p">(</span><span class="n">info</span><span class="p">);</span>
<span class="w">            </span><span class="k">auto</span><span class="w"> </span><span class="n">pnp_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">get_connected_device_pnp_id</span><span class="p">(</span><span class="n">info</span><span class="p">);</span>
<span class="w">            </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;            RSSI:  {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">rssi</span><span class="p">);</span>
<span class="w">            </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;            Name:  {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<span class="w">            </span><span class="c1">// NOTE: these are optionals, so they may not be set</span>
<span class="w">            </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;            Mfg:   {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">mfg_name</span><span class="p">);</span>
<span class="w">            </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;            Model: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">model_number</span><span class="p">);</span>
<span class="w">            </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;            PnP:   {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pnp_id</span><span class="p">);</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">was_connected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">        </span><span class="n">can_exit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">is_connected</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">was_connected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">can_exit</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;No longer connected, exiting&quot;</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">is_connected</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">logger</span><span class="p">.</span><span class="n">move_up</span><span class="p">();</span>
<span class="w">        </span><span class="n">logger</span><span class="p">.</span><span class="n">clear_line</span><span class="p">();</span>
<span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">steady_clock</span><span class="o">::</span><span class="n">now</span><span class="p">();</span>
<span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">elapsed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">duration_cast</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">seconds</span><span class="o">&gt;</span><span class="p">(</span><span class="n">now</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">loop_start</span><span class="p">);</span>
<span class="w">        </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Waiting for connection... {}s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">num_seconds_to_wait</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">elapsed</span><span class="p">.</span><span class="n">count</span><span class="p">());</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">elapsed</span><span class="p">.</span><span class="n">count</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">num_seconds_to_wait</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;No connection, exiting&quot;</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c1">// sleep</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">this_thread</span><span class="o">::</span><span class="n">sleep_until</span><span class="p">(</span><span class="n">start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">100</span><span class="n">ms</span><span class="p">);</span>
<span class="w">        </span><span class="k">continue</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// update the battery level</span>
<span class="w">      </span><span class="n">battery_service</span><span class="p">.</span><span class="n">set_battery_level</span><span class="p">(</span><span class="n">battery_level</span><span class="p">);</span>
<span class="w">      </span><span class="n">battery_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">battery_level</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// sleep</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">this_thread</span><span class="o">::</span><span class="n">sleep_until</span><span class="p">(</span><span class="n">start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">100</span><span class="n">ms</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// we are done, so stop the server and deinit the BLE stack. NOTE: this will</span>
<span class="w">    </span><span class="c1">// automatically be called by ~BleGattServer(), but we call it here to show</span>
<span class="w">    </span><span class="c1">// manual control and to test calling it multiple times since the destructor</span>
<span class="w">    </span><span class="c1">// will be called immediately after this block ends</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">deinit</span><span class="p">();</span>
</pre></div>
</div>
</section>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-types">Public Types</p>
<dl class="cpp enum-class">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer16DisconnectReasonE">
<span id="_CPPv3N4espp13BleGattServer16DisconnectReasonE"></span><span id="_CPPv2N4espp13BleGattServer16DisconnectReasonE"></span><span class="target" id="classespp_1_1BleGattServer_1a5c03a01eb43c0bfad4cc2a175e186d0d"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DisconnectReason</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer16DisconnectReasonE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Disconnect reasons for the GATT server. This enum represents the different reasons for disconnection that will be passed to the disconnect callback. </p>
<p>This enum is a simplification of the NimBLE disconnect reasons, and is meant to provide a more user-friendly way to handle disconnections. For more information about the possible reasons for disconnection, see <a class="reference external" href="https://mynewt.apache.org/latest/network/ble_hs/ble_hs_return_codes.html">https://mynewt.apache.org/latest/network/ble_hs/ble_hs_return_codes.html</a>. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer16DisconnectReason7UNKNOWNE">
<span id="_CPPv3N4espp13BleGattServer16DisconnectReason7UNKNOWNE"></span><span id="_CPPv2N4espp13BleGattServer16DisconnectReason7UNKNOWNE"></span><span class="target" id="classespp_1_1BleGattServer_1a5c03a01eb43c0bfad4cc2a175e186d0da696b031073e74bf2cb98e5ef201d4aa3"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">UNKNOWN</span></span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer16DisconnectReason7UNKNOWNE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Unknown reason for disconnection. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer16DisconnectReason7TIMEOUTE">
<span id="_CPPv3N4espp13BleGattServer16DisconnectReason7TIMEOUTE"></span><span id="_CPPv2N4espp13BleGattServer16DisconnectReason7TIMEOUTE"></span><span class="target" id="classespp_1_1BleGattServer_1a5c03a01eb43c0bfad4cc2a175e186d0da070a0fb40f6c308ab544b227660aadff"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TIMEOUT</span></span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer16DisconnectReason7TIMEOUTE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Disconnected due to timeout. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer16DisconnectReason21CONNECTION_TERMINATEDE">
<span id="_CPPv3N4espp13BleGattServer16DisconnectReason21CONNECTION_TERMINATEDE"></span><span id="_CPPv2N4espp13BleGattServer16DisconnectReason21CONNECTION_TERMINATEDE"></span><span class="target" id="classespp_1_1BleGattServer_1a5c03a01eb43c0bfad4cc2a175e186d0daf1eecc350f2725010f984356453a1b8a"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CONNECTION_TERMINATED</span></span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer16DisconnectReason21CONNECTION_TERMINATEDE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Disconnected due to the connection being terminated. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer16DisconnectReason22REMOTE_USER_TERMINATEDE">
<span id="_CPPv3N4espp13BleGattServer16DisconnectReason22REMOTE_USER_TERMINATEDE"></span><span id="_CPPv2N4espp13BleGattServer16DisconnectReason22REMOTE_USER_TERMINATEDE"></span><span class="target" id="classespp_1_1BleGattServer_1a5c03a01eb43c0bfad4cc2a175e186d0da4830f334077071e8a76d98b21407be8f"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">REMOTE_USER_TERMINATED</span></span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer16DisconnectReason22REMOTE_USER_TERMINATEDE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Disconnected due to the remote user terminating the connection. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer16DisconnectReason24REMOTE_DEVICE_TERMINATEDE">
<span id="_CPPv3N4espp13BleGattServer16DisconnectReason24REMOTE_DEVICE_TERMINATEDE"></span><span id="_CPPv2N4espp13BleGattServer16DisconnectReason24REMOTE_DEVICE_TERMINATEDE"></span><span class="target" id="classespp_1_1BleGattServer_1a5c03a01eb43c0bfad4cc2a175e186d0da7b0e3a9ad979f7aebc7e7a049bb14304"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">REMOTE_DEVICE_TERMINATED</span></span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer16DisconnectReason24REMOTE_DEVICE_TERMINATEDE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Disconnected due to the remote device terminating the connection (low resources or power off) </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer16DisconnectReason21LOCAL_USER_TERMINATEDE">
<span id="_CPPv3N4espp13BleGattServer16DisconnectReason21LOCAL_USER_TERMINATEDE"></span><span id="_CPPv2N4espp13BleGattServer16DisconnectReason21LOCAL_USER_TERMINATEDE"></span><span class="target" id="classespp_1_1BleGattServer_1a5c03a01eb43c0bfad4cc2a175e186d0dabe7e1a55b082c9fe2e66d283ba663a87"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LOCAL_USER_TERMINATED</span></span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer16DisconnectReason21LOCAL_USER_TERMINATEDE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Disconnected due to the local user terminating the connection. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer16DisconnectReason22AUTHENTICATION_FAILUREE">
<span id="_CPPv3N4espp13BleGattServer16DisconnectReason22AUTHENTICATION_FAILUREE"></span><span id="_CPPv2N4espp13BleGattServer16DisconnectReason22AUTHENTICATION_FAILUREE"></span><span class="target" id="classespp_1_1BleGattServer_1a5c03a01eb43c0bfad4cc2a175e186d0dac05a8ff082424bb508ab0c2d4c106c85"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AUTHENTICATION_FAILURE</span></span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer16DisconnectReason22AUTHENTICATION_FAILUREE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Disconnected due to an authentication failure. </p>
</dd></dl>

</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer18connect_callback_tE">
<span id="_CPPv3N4espp13BleGattServer18connect_callback_tE"></span><span id="_CPPv2N4espp13BleGattServer18connect_callback_tE"></span><span id="espp::BleGattServer::connect_callback_t"></span><span class="target" id="classespp_1_1BleGattServer_1a4c3a245bece906026eab24feaac51798"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">NimBLEConnInfo</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">connect_callback_t</span></span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer18connect_callback_tE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Callback for when a device connects to the GATT server. </p>
<dl class="field-list simple">
<dt class="field-odd">Param conn_info<span class="colon">:</span></dt>
<dd class="field-odd"><p>The connection information for the device. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer21disconnect_callback_tE">
<span id="_CPPv3N4espp13BleGattServer21disconnect_callback_tE"></span><span id="_CPPv2N4espp13BleGattServer21disconnect_callback_tE"></span><span id="espp::BleGattServer::disconnect_callback_t"></span><span class="target" id="classespp_1_1BleGattServer_1a296151ecc7aba17a58891d82f6ec204d"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">NimBLEConnInfo</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4espp13BleGattServer16DisconnectReasonE" title="espp::BleGattServer::DisconnectReason"><span class="n"><span class="pre">DisconnectReason</span></span></a><span class="w"> </span><span class="n"><span class="pre">reason</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">disconnect_callback_t</span></span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer21disconnect_callback_tE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Callback for when a device disconnects from the GATT server. </p>
<dl class="field-list simple">
<dt class="field-odd">Param conn_info<span class="colon">:</span></dt>
<dd class="field-odd"><p>The connection information for the device. </p>
</dd>
<dt class="field-even">Param reason<span class="colon">:</span></dt>
<dd class="field-even"><p>The reason for the disconnection. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer34authentication_complete_callback_tE">
<span id="_CPPv3N4espp13BleGattServer34authentication_complete_callback_tE"></span><span id="_CPPv2N4espp13BleGattServer34authentication_complete_callback_tE"></span><span id="espp::BleGattServer::authentication_complete_callback_t"></span><span class="target" id="classespp_1_1BleGattServer_1ae58265eb27635c6716b96a8a0f0ab394"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">NimBLEConnInfo</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">authentication_complete_callback_t</span></span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer34authentication_complete_callback_tE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Callback for when a device completes authentication. </p>
<dl class="field-list simple">
<dt class="field-odd">Param conn_info<span class="colon">:</span></dt>
<dd class="field-odd"><p>The connection information for the device. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer22get_passkey_callback_tE">
<span id="_CPPv3N4espp13BleGattServer22get_passkey_callback_tE"></span><span id="_CPPv2N4espp13BleGattServer22get_passkey_callback_tE"></span><span id="espp::BleGattServer::get_passkey_callback_t"></span><span class="target" id="classespp_1_1BleGattServer_1abf5c3783b0928feccffc23899b3ef341"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_passkey_callback_t</span></span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer22get_passkey_callback_tE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Callback to retrieve the passkey for the device. </p>
<dl class="field-list simple">
<dt class="field-odd">Return<span class="colon">:</span></dt>
<dd class="field-odd"><p>The passkey for the device. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer26confirm_passkey_callback_tE">
<span id="_CPPv3N4espp13BleGattServer26confirm_passkey_callback_tE"></span><span id="_CPPv2N4espp13BleGattServer26confirm_passkey_callback_tE"></span><span id="espp::BleGattServer::confirm_passkey_callback_t"></span><span class="target" id="classespp_1_1BleGattServer_1a17735198f3385e10612e4bb12c28931a"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">NimBLEConnInfo</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n"><span class="pre">conn_info</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">confirm_passkey_callback_t</span></span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer26confirm_passkey_callback_tE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Callback for confirming the passkey. </p>
<dl class="field-list simple">
<dt class="field-odd">Param conn_info<span class="colon">:</span></dt>
<dd class="field-odd"><p>The connection information for the device. </p>
</dd>
<dt class="field-even">Param passkey<span class="colon">:</span></dt>
<dd class="field-even"><p>The passkey for the device. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer32advertisement_stopped_callback_tE">
<span id="_CPPv3N4espp13BleGattServer32advertisement_stopped_callback_tE"></span><span id="_CPPv2N4espp13BleGattServer32advertisement_stopped_callback_tE"></span><span id="espp::BleGattServer::advertisement_stopped_callback_t"></span><span class="target" id="classespp_1_1BleGattServer_1aa58de0fe55a0f3d5ed8e24345fcd1906"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">NimBLEExtAdvertising</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">advertisement_stopped_callback_t</span></span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer32advertisement_stopped_callback_tE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Callback for when advertising is stopped. This callback is called when advertising is stopped. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is only available when CONFIG_BT_NIMBLE_EXT_ADV is enabled. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Param advertising<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pointer to the advertising object. </p>
</dd>
<dt class="field-even">Param reason<span class="colon">:</span></dt>
<dd class="field-even"><p>The reason for stopping advertising. </p>
</dd>
<dt class="field-odd">Param instance<span class="colon">:</span></dt>
<dd class="field-odd"><p>The advertising instance that was stopped. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer23scan_request_callback_tE">
<span id="_CPPv3N4espp13BleGattServer23scan_request_callback_tE"></span><span id="_CPPv2N4espp13BleGattServer23scan_request_callback_tE"></span><span id="espp::BleGattServer::scan_request_callback_t"></span><span class="target" id="classespp_1_1BleGattServer_1a1f75eb7f24a7d26a5fe08146fb4d00db"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">NimBLEExtAdvertising</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">NimBLEAddress</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scan_request_callback_t</span></span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer23scan_request_callback_tE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Callback for when a scan request is received. This callback is called when a scan request is received. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is only available when CONFIG_BT_NIMBLE_EXT_ADV is enabled. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Param advertising<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pointer to the advertising object. </p>
</dd>
<dt class="field-even">Param instance<span class="colon">:</span></dt>
<dd class="field-even"><p>The advertising instance that received the scan request. </p>
</dd>
<dt class="field-odd">Param address<span class="colon">:</span></dt>
<dd class="field-odd"><p>The address of the device that sent the scan request. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer33advertisement_complete_callback_tE">
<span id="_CPPv3N4espp13BleGattServer33advertisement_complete_callback_tE"></span><span id="_CPPv2N4espp13BleGattServer33advertisement_complete_callback_tE"></span><span id="espp::BleGattServer::advertisement_complete_callback_t"></span><span class="target" id="classespp_1_1BleGattServer_1a344a89c5ee458fad2b06111008c141e7"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">NimBLEAdvertising</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">advertisement_complete_callback_t</span></span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer33advertisement_complete_callback_tE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Callback for when advertising is complete. This callback is called when advertising is complete. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is called when advertising is complete, not when the device is actually advertising. It will not be called if the advertisement duration is 0 (i.e. no timeout). </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is only available when CONFIG_BT_NIMBLE_EXT_ADV is not enabled. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Param advertising<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pointer to the advertising object. </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer13BleGattServerEv">
<span id="_CPPv3N4espp13BleGattServer13BleGattServerEv"></span><span id="_CPPv2N4espp13BleGattServer13BleGattServerEv"></span><span id="espp::BleGattServer::BleGattServer"></span><span class="target" id="classespp_1_1BleGattServer_1ab807630cb481411f571db1bba1ab8825"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BleGattServer</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer13BleGattServerEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Constructor for the GATT server. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer13BleGattServerERK6Config">
<span id="_CPPv3N4espp13BleGattServer13BleGattServerERK6Config"></span><span id="_CPPv2N4espp13BleGattServer13BleGattServerERK6Config"></span><span id="espp::BleGattServer::BleGattServer__ConfigCR"></span><span class="target" id="classespp_1_1BleGattServer_1a0aa8994b492d8e8397a0406d8ce433b5"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BleGattServer</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4espp13BleGattServer6ConfigE" title="espp::BleGattServer::Config"><span class="n"><span class="pre">Config</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">config</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer13BleGattServerERK6Config" title="Permalink to this definition"></a><br /></dt>
<dd><p>Constructor </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> – The configuration for the GATT server. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServerD0Ev">
<span id="_CPPv3N4espp13BleGattServerD0Ev"></span><span id="_CPPv2N4espp13BleGattServerD0Ev"></span><span id="espp::BleGattServer::~BleGattServer"></span><span class="target" id="classespp_1_1BleGattServer_1a99c6a5f00d8f13ac6d5479bcc034cb63"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">~BleGattServer</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServerD0Ev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Destructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer12is_connectedEv">
<span id="_CPPv3NK4espp13BleGattServer12is_connectedEv"></span><span id="_CPPv2NK4espp13BleGattServer12is_connectedEv"></span><span id="espp::BleGattServer::is_connectedC"></span><span class="target" id="classespp_1_1BleGattServer_1a87f02501c136a10ffa71c35ac4984220"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">is_connected</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer12is_connectedEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get whether the GATT server is connected to any clients. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will return false if the server is not created. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether the GATT server is connected to any clients. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer13set_callbacksERK9Callbacks">
<span id="_CPPv3N4espp13BleGattServer13set_callbacksERK9Callbacks"></span><span id="_CPPv2N4espp13BleGattServer13set_callbacksERK9Callbacks"></span><span id="espp::BleGattServer::set_callbacks__CallbacksCR"></span><span class="target" id="classespp_1_1BleGattServer_1a96db228bfcdeba4e4d0d5dde5da0cc41"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_callbacks</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4espp13BleGattServer9CallbacksE" title="espp::BleGattServer::Callbacks"><span class="n"><span class="pre">Callbacks</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">callbacks</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer13set_callbacksERK9Callbacks" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set the callbacks for the GATT server. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>callbacks</strong> – The callbacks for the GATT server. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer4initERKNSt6stringE">
<span id="_CPPv3N4espp13BleGattServer4initERKNSt6stringE"></span><span id="_CPPv2N4espp13BleGattServer4initERKNSt6stringE"></span><span id="espp::BleGattServer::init__ssCR"></span><span class="target" id="classespp_1_1BleGattServer_1a9b6973b04a9c526939214fb5e12d1219"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">init</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">device_name</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer4initERKNSt6stringE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Initialize the GATT server This method creates the GATT server and sets the callbacks to this class. It also initializes the device info and battery services. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method must be called before creating any other services or characteristics. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method must be called before starting the server. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device_name</strong> – The name of the device. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether the GATT server was initialized successfully. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer6deinitEv">
<span id="_CPPv3N4espp13BleGattServer6deinitEv"></span><span id="_CPPv2N4espp13BleGattServer6deinitEv"></span><span id="espp::BleGattServer::deinit"></span><span class="target" id="classespp_1_1BleGattServer_1a8c5228b0b141b7efdaad4a0565769435"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">deinit</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer6deinitEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Deinitialize the GATT server This method deletes the server and all associated objects. It also invalidates any references/pointers to the server. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After calling this method, any references/pointers to the server and any created services/characteristics will be invalid. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method should only be called after NimBLEDevice::deinit(true) has been called, since that will free the memory used by the server. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method will also deinitialize the device info and battery services. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer14start_servicesEv">
<span id="_CPPv3N4espp13BleGattServer14start_servicesEv"></span><span id="_CPPv2N4espp13BleGattServer14start_servicesEv"></span><span id="espp::BleGattServer::start_services"></span><span class="target" id="classespp_1_1BleGattServer_1a7bbd820977fbc121a2e8d365cf90d198"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">start_services</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer14start_servicesEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Start the services This method starts the device info and battery services. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer5startEv">
<span id="_CPPv3N4espp13BleGattServer5startEv"></span><span id="_CPPv2N4espp13BleGattServer5startEv"></span><span id="espp::BleGattServer::start"></span><span class="target" id="classespp_1_1BleGattServer_1aeabe0e8c83dc87823d74b8d11eddda64"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">start</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer5startEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Start the server This method starts the GATT server. This method must be called after the server has been initialized, and after any services / characteristics have been added to the server. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether the server was started successfully. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer27set_advertise_on_disconnectEb">
<span id="_CPPv3N4espp13BleGattServer27set_advertise_on_disconnectEb"></span><span id="_CPPv2N4espp13BleGattServer27set_advertise_on_disconnectEb"></span><span id="espp::BleGattServer::set_advertise_on_disconnect__b"></span><span class="target" id="classespp_1_1BleGattServer_1ab5d5aa9f8f912106206151b75e375da3"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_advertise_on_disconnect</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">advertise_on_disconnect</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer27set_advertise_on_disconnectEb" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set whether to advertise on disconnect </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only available when CONFIG_BT_NIMBLE_EXT_ADV is not enabled, ane legacy advertising is used. Otherwise, you will have to manually start advertising after disconnecting. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>advertise_on_disconnect</strong> – Whether to advertise on disconnect </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer22set_advertisement_dataERK14AdvertisedData7uint8_t">
<span id="_CPPv3N4espp13BleGattServer22set_advertisement_dataERK14AdvertisedData7uint8_t"></span><span id="_CPPv2N4espp13BleGattServer22set_advertisement_dataERK14AdvertisedData7uint8_t"></span><span id="espp::BleGattServer::set_advertisement_data__AdvertisedDataCR.uint8_t"></span><span class="target" id="classespp_1_1BleGattServer_1aaa2672a2825b4028175809af89ace7e6"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_advertisement_data</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">AdvertisedData</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">advertising_data</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">instance</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer22set_advertisement_dataERK14AdvertisedData7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set the advertisement data for the device. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is only available when CONFIG_BT_NIMBLE_EXT_ADV is enabled. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>advertising_data</strong> – The advertising data for the device. </p></li>
<li><p><strong>instance</strong> – The advertising instance to set the data for. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer22set_scan_response_dataERK14AdvertisedData7uint8_t">
<span id="_CPPv3N4espp13BleGattServer22set_scan_response_dataERK14AdvertisedData7uint8_t"></span><span id="_CPPv2N4espp13BleGattServer22set_scan_response_dataERK14AdvertisedData7uint8_t"></span><span id="espp::BleGattServer::set_scan_response_data__AdvertisedDataCR.uint8_t"></span><span class="target" id="classespp_1_1BleGattServer_1a9bc15b42f9850516fe75fc7fb5df868d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_scan_response_data</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">AdvertisedData</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">scan_response_data</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">instance</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer22set_scan_response_dataERK14AdvertisedData7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set the scan response data for the device. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is only available when CONFIG_BT_NIMBLE_EXT_ADV is enabled. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scan_response_data</strong> – The scan response data for the device. </p></li>
<li><p><strong>instance</strong> – The advertising instance to set the data for. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer22set_advertisement_dataERK14AdvertisedData">
<span id="_CPPv3N4espp13BleGattServer22set_advertisement_dataERK14AdvertisedData"></span><span id="_CPPv2N4espp13BleGattServer22set_advertisement_dataERK14AdvertisedData"></span><span id="espp::BleGattServer::set_advertisement_data__AdvertisedDataCR"></span><span class="target" id="classespp_1_1BleGattServer_1a6c8e9d2000f9686d36b5b9f18b310bc3"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_advertisement_data</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">AdvertisedData</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">advertising_data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer22set_advertisement_dataERK14AdvertisedData" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set the advertisement data for the device. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is only available when CONFIG_BT_NIMBLE_EXT_ADV is disabled. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>advertising_data</strong> – The advertising data for the device. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer22set_scan_response_dataERK14AdvertisedData">
<span id="_CPPv3N4espp13BleGattServer22set_scan_response_dataERK14AdvertisedData"></span><span id="_CPPv2N4espp13BleGattServer22set_scan_response_dataERK14AdvertisedData"></span><span id="espp::BleGattServer::set_scan_response_data__AdvertisedDataCR"></span><span class="target" id="classespp_1_1BleGattServer_1a65e97d75a2bc88dc185a6f656cf01f7a"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_scan_response_data</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">AdvertisedData</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">scan_response_data</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer22set_scan_response_dataERK14AdvertisedData" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set the scan response data for the device. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is only available when CONFIG_BT_NIMBLE_EXT_ADV is disabled. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scan_response_data</strong> – The scan response data for the device. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer16stop_advertisingEv">
<span id="_CPPv3N4espp13BleGattServer16stop_advertisingEv"></span><span id="_CPPv2N4espp13BleGattServer16stop_advertisingEv"></span><span id="espp::BleGattServer::stop_advertising"></span><span class="target" id="classespp_1_1BleGattServer_1aae92d62842373e3476e473f90b7b201f"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">stop_advertising</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer16stop_advertisingEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Stop advertising This method stops advertising. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer16stop_advertisingE7uint8_t">
<span id="_CPPv3N4espp13BleGattServer16stop_advertisingE7uint8_t"></span><span id="_CPPv2N4espp13BleGattServer16stop_advertisingE7uint8_t"></span><span id="espp::BleGattServer::stop_advertising__uint8_t"></span><span class="target" id="classespp_1_1BleGattServer_1a0f44cefc5efed39049aca8a96e682814"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">stop_advertising</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">instance</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer16stop_advertisingE7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Stop advertising This method stops advertising. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is only available when CONFIG_BT_NIMBLE_EXT_ADV is enabled. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>instance</strong> – The advertising instance to stop. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer17start_advertisingE8uint32_t7uint8_t">
<span id="_CPPv3N4espp13BleGattServer17start_advertisingE8uint32_t7uint8_t"></span><span id="_CPPv2N4espp13BleGattServer17start_advertisingE8uint32_t7uint8_t"></span><span id="espp::BleGattServer::start_advertising__uint32_t.uint8_t"></span><span class="target" id="classespp_1_1BleGattServer_1a0b0560887c093b1d62e695dbbc13200a"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">start_advertising</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">duration_ms</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span>, <span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">instance</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer17start_advertisingE8uint32_t7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Start Advertising using the previously set advertising data This method simply starts advertising using the previously set advertising data. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is only available when CONFIG_BT_NIMBLE_EXT_ADV is enabled. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>duration_ms</strong> – The duration of the advertising in milliseconds. If 0, the advertising will not timeout. If non-zero, the advertising will stop after the specified duration. </p></li>
<li><p><strong>instance</strong> – The advertising instance to start. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether advertising was started successfully. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer17start_advertisingERK21AdvertisingParameters">
<span id="_CPPv3N4espp13BleGattServer17start_advertisingERK21AdvertisingParameters"></span><span id="_CPPv2N4espp13BleGattServer17start_advertisingERK21AdvertisingParameters"></span><span id="espp::BleGattServer::start_advertising__AdvertisingParametersCR"></span><span class="target" id="classespp_1_1BleGattServer_1a898d17038d4d1b849c1a93fa08179890"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">start_advertising</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4espp13BleGattServer21AdvertisingParametersE" title="espp::BleGattServer::AdvertisingParameters"><span class="n"><span class="pre">AdvertisingParameters</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer17start_advertisingERK21AdvertisingParameters" title="Permalink to this definition"></a><br /></dt>
<dd><p>Start Advertising using the previously set advertising data This method simply starts advertising using the previously set advertising data. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only used when CONFIG_BT_NIMBLE_EXT_ADV is not enabled, ane legacy advertising is used. Otherwise, use the NimBLEExtAdvertisement class for advertising and setting the advertising parameters. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> – The advertising parameters for the device. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether advertising was started successfully. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer17start_advertisingE8uint32_tP13NimBLEAddress">
<span id="_CPPv3N4espp13BleGattServer17start_advertisingE8uint32_tP13NimBLEAddress"></span><span id="_CPPv2N4espp13BleGattServer17start_advertisingE8uint32_tP13NimBLEAddress"></span><span id="espp::BleGattServer::start_advertising__uint32_t.NimBLEAddressP"></span><span class="target" id="classespp_1_1BleGattServer_1a7d90e7dadc10c34a6e53ea9d6b5e116e"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">start_advertising</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">duration_ms</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span>, <span class="n"><span class="pre">NimBLEAddress</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">directed_address</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer17start_advertisingE8uint32_tP13NimBLEAddress" title="Permalink to this definition"></a><br /></dt>
<dd><p>Start Advertising using the previously set advertising data This method simply starts advertising using the previously set advertising data. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is only used when CONFIG_BT_NIMBLE_EXT_ADV is not enabled, ane legacy advertising is used. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>duration_ms</strong> – The duration of the advertising in milliseconds. If 0, the advertising will not timeout. If non-zero, the advertising will stop after the specified duration. </p></li>
<li><p><strong>directed_address</strong> – The address to direct advertising to, if any. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether advertising was started successfully. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer6serverEv">
<span id="_CPPv3NK4espp13BleGattServer6serverEv"></span><span id="_CPPv2NK4espp13BleGattServer6serverEv"></span><span id="espp::BleGattServer::serverC"></span><span class="target" id="classespp_1_1BleGattServer_1a47b9859016ee082e2fba396d0877977d"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">NimBLEServer</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">server</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer6serverEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the GATT server. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The GATT server. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer19device_info_serviceEv">
<span id="_CPPv3N4espp13BleGattServer19device_info_serviceEv"></span><span id="_CPPv2N4espp13BleGattServer19device_info_serviceEv"></span><span id="espp::BleGattServer::device_info_service"></span><span class="target" id="classespp_1_1BleGattServer_1ae0426bbadb6d4e2965f9e10db965375d"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><a class="reference internal" href="device_info_service.html#_CPPv4N4espp17DeviceInfoServiceE" title="espp::DeviceInfoService"><span class="n"><span class="pre">DeviceInfoService</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">device_info_service</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer19device_info_serviceEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the device info service. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer15battery_serviceEv">
<span id="_CPPv3N4espp13BleGattServer15battery_serviceEv"></span><span id="_CPPv2N4espp13BleGattServer15battery_serviceEv"></span><span id="espp::BleGattServer::battery_service"></span><span class="target" id="classespp_1_1BleGattServer_1a2dfb42c2ef804303dfb893e84a87de78"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><a class="reference internal" href="battery_service.html#_CPPv4N4espp14BatteryServiceE" title="espp::BatteryService"><span class="n"><span class="pre">BatteryService</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">battery_service</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer15battery_serviceEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the battery service. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer15set_device_nameERKNSt6stringE">
<span id="_CPPv3NK4espp13BleGattServer15set_device_nameERKNSt6stringE"></span><span id="_CPPv2NK4espp13BleGattServer15set_device_nameERKNSt6stringE"></span><span id="espp::BleGattServer::set_device_name__ssCRC"></span><span class="target" id="classespp_1_1BleGattServer_1ab890be042b707537e7936d39a29b257d"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_device_name</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">device_name</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer15set_device_nameERKNSt6stringE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set the name of the device. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device_name</strong> – The name of the device. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer11set_passkeyE8uint32_t">
<span id="_CPPv3NK4espp13BleGattServer11set_passkeyE8uint32_t"></span><span id="_CPPv2NK4espp13BleGattServer11set_passkeyE8uint32_t"></span><span id="espp::BleGattServer::set_passkey__uint32_tC"></span><span class="target" id="classespp_1_1BleGattServer_1a13130a12293dba28355bdbea81450021"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_passkey</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">passkey</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer11set_passkeyE8uint32_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set the passkey for the device. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>passkey</strong> – The passkey for the device. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer12set_securityEbbb">
<span id="_CPPv3NK4espp13BleGattServer12set_securityEbbb"></span><span id="_CPPv2NK4espp13BleGattServer12set_securityEbbb"></span><span id="espp::BleGattServer::set_security__b.b.bC"></span><span class="target" id="classespp_1_1BleGattServer_1a701934943c1b28e06fa4e39a43265baa"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_security</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bonding</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">mitm</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">secure</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer12set_securityEbbb" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set the security settings for the device. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bonding</strong> – Whether to use bonding. </p></li>
<li><p><strong>mitm</strong> – Man-in-the-middle protection. </p></li>
<li><p><strong>secure</strong> – Whether to use secure connections. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer19set_io_capabilitiesE7uint8_t">
<span id="_CPPv3NK4espp13BleGattServer19set_io_capabilitiesE7uint8_t"></span><span id="_CPPv2NK4espp13BleGattServer19set_io_capabilitiesE7uint8_t"></span><span id="espp::BleGattServer::set_io_capabilities__uint8_tC"></span><span class="target" id="classespp_1_1BleGattServer_1a63932318a8c42a7d3733f219688527be"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_io_capabilities</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">io_capabilities</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer19set_io_capabilitiesE7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set the IO capabilities for the device. <div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>BLE_HS_IO_NO_INPUT_OUTPUT </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>BLE_HS_IO_DISPLAY_ONLY </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>BLE_HS_IO_DISPLAY_YESNO </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>BLE_HS_IO_KEYBOARD_ONLY </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>BLE_HS_IO_NO_INPUT_OUTPUT </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>BLE_HS_IO_KEYBOARD_DISPLAY </p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>io_capabilities</strong> – The IO capabilities for the device. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer25set_init_key_distributionE7uint8_t">
<span id="_CPPv3NK4espp13BleGattServer25set_init_key_distributionE7uint8_t"></span><span id="_CPPv2NK4espp13BleGattServer25set_init_key_distributionE7uint8_t"></span><span id="espp::BleGattServer::set_init_key_distribution__uint8_tC"></span><span class="target" id="classespp_1_1BleGattServer_1adcf81df4aec5ecaedaa2e056f77bf100"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_init_key_distribution</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">key_distribution</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer25set_init_key_distributionE7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set the initial key distribution for the device. <div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>BLE_SM_PAIR_KEY_DIST_ENC </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>BLE_SM_PAIR_KEY_DIST_ID </p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key_distribution</strong> – The initial key distribution for the device. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer25set_resp_key_distributionE7uint8_t">
<span id="_CPPv3NK4espp13BleGattServer25set_resp_key_distributionE7uint8_t"></span><span id="_CPPv2NK4espp13BleGattServer25set_resp_key_distributionE7uint8_t"></span><span id="espp::BleGattServer::set_resp_key_distribution__uint8_tC"></span><span class="target" id="classespp_1_1BleGattServer_1a707a43ff4c4da2eda2d0f249cda4f0a4"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_resp_key_distribution</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">key_distribution</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer25set_resp_key_distributionE7uint8_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set the response key distribution for the device. <div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>BLE_SM_PAIR_KEY_DIST_ENC </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>BLE_SM_PAIR_KEY_DIST_ID </p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key_distribution</strong> – The response key distribution for the device. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer18get_paired_devicesEv">
<span id="_CPPv3NK4espp13BleGattServer18get_paired_devicesEv"></span><span id="_CPPv2NK4espp13BleGattServer18get_paired_devicesEv"></span><span id="espp::BleGattServer::get_paired_devicesC"></span><span class="target" id="classespp_1_1BleGattServer_1a51c257a77af13e2f839635fb65dcc867"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">NimBLEAddress</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_paired_devices</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer18get_paired_devicesEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the paired devices </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The paired devices as a vector of Addresses. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer28get_connected_device_handlesEv">
<span id="_CPPv3NK4espp13BleGattServer28get_connected_device_handlesEv"></span><span id="_CPPv2NK4espp13BleGattServer28get_connected_device_handlesEv"></span><span id="espp::BleGattServer::get_connected_device_handlesC"></span><span class="target" id="classespp_1_1BleGattServer_1a08a2f860c9e760368267811fe4c37b90"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint16_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_connected_device_handles</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer28get_connected_device_handlesEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the connected handles </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will return an empty vector if the server is not created. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will return the handles of the connected devices. These handles can be used to retrieve the connection information for the devices. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The connected handles. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer30get_connected_device_addressesEv">
<span id="_CPPv3NK4espp13BleGattServer30get_connected_device_addressesEv"></span><span id="_CPPv2NK4espp13BleGattServer30get_connected_device_addressesEv"></span><span id="espp::BleGattServer::get_connected_device_addressesC"></span><span class="target" id="classespp_1_1BleGattServer_1a77ca5a90341f18309c7cb37fea8b941f"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">NimBLEAddress</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_connected_device_addresses</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer30get_connected_device_addressesEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the connected device addresses </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The addresses for the connected devices as a vector. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer26get_connected_device_infosEv">
<span id="_CPPv3NK4espp13BleGattServer26get_connected_device_infosEv"></span><span id="_CPPv2NK4espp13BleGattServer26get_connected_device_infosEv"></span><span id="espp::BleGattServer::get_connected_device_infosC"></span><span class="target" id="classespp_1_1BleGattServer_1ae866493471d4decb1842d6a85a9b4b97"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">NimBLEConnInfo</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_connected_device_infos</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer26get_connected_device_infosEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the NimBLEConnInfo objects for the connected devices </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The connected devices info as a vector of NimBLEConnInfo. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer25get_connected_device_nameERK14NimBLEConnInfo">
<span id="_CPPv3NK4espp13BleGattServer25get_connected_device_nameERK14NimBLEConnInfo"></span><span id="_CPPv2NK4espp13BleGattServer25get_connected_device_nameERK14NimBLEConnInfo"></span><span id="espp::BleGattServer::get_connected_device_name__NimBLEConnInfoCRC"></span><span class="target" id="classespp_1_1BleGattServer_1a397a005b8c57965b4017bb4d55bb89cd"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_connected_device_name</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">NimBLEConnInfo</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">conn_info</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer25get_connected_device_nameERK14NimBLEConnInfo" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the connected device name </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>conn_info</strong> – The connection information for the device. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The connected device name. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer31get_connected_device_appearanceERK14NimBLEConnInfo">
<span id="_CPPv3NK4espp13BleGattServer31get_connected_device_appearanceERK14NimBLEConnInfo"></span><span id="_CPPv2NK4espp13BleGattServer31get_connected_device_appearanceERK14NimBLEConnInfo"></span><span id="espp::BleGattServer::get_connected_device_appearance__NimBLEConnInfoCRC"></span><span class="target" id="classespp_1_1BleGattServer_1a43b0c79484a9632b57082c6a74e7dca8"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint16_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_connected_device_appearance</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">NimBLEConnInfo</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">conn_info</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer31get_connected_device_appearanceERK14NimBLEConnInfo" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the connected device appearance </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>conn_info</strong> – The connection information for the device. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The connected device appearance. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer27get_connected_device_pnp_idERK14NimBLEConnInfo">
<span id="_CPPv3NK4espp13BleGattServer27get_connected_device_pnp_idERK14NimBLEConnInfo"></span><span id="_CPPv2NK4espp13BleGattServer27get_connected_device_pnp_idERK14NimBLEConnInfo"></span><span id="espp::BleGattServer::get_connected_device_pnp_id__NimBLEConnInfoCRC"></span><span class="target" id="classespp_1_1BleGattServer_1a5fa635f1fff519c560b25395096e15cb"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="device_info_service.html#_CPPv4N4espp17DeviceInfoServiceE" title="espp::DeviceInfoService"><span class="n"><span class="pre">DeviceInfoService</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="device_info_service.html#_CPPv4N4espp17DeviceInfoService5PnpIdE" title="espp::DeviceInfoService::PnpId"><span class="n"><span class="pre">PnpId</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_connected_device_pnp_id</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">NimBLEConnInfo</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">conn_info</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer27get_connected_device_pnp_idERK14NimBLEConnInfo" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the connected device PnP ID </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method will connect to the device to get the PnP ID. This may take some time if the device is not already connected. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The remote device may not expose a Device Information Service, in which case this method will return an empty optional. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>conn_info</strong> – The connection information for the device. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The connected device PnP ID. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer38get_connected_device_manufacturer_nameERK14NimBLEConnInfo">
<span id="_CPPv3NK4espp13BleGattServer38get_connected_device_manufacturer_nameERK14NimBLEConnInfo"></span><span id="_CPPv2NK4espp13BleGattServer38get_connected_device_manufacturer_nameERK14NimBLEConnInfo"></span><span id="espp::BleGattServer::get_connected_device_manufacturer_name__NimBLEConnInfoCRC"></span><span class="target" id="classespp_1_1BleGattServer_1a4b65cc9a0c7421d67330e527d5f7acb9"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_connected_device_manufacturer_name</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">NimBLEConnInfo</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">conn_info</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer38get_connected_device_manufacturer_nameERK14NimBLEConnInfo" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the connected device Manufacturer Name string </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method will connect to the device to read the characteristic. This may take some time if the device is not already connected. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The remote device may not expose a Device Information Service, in which case this method will return an empty optional. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>conn_info</strong> – The connection information for the device. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The connected device Manufacturer Name string. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer33get_connected_device_model_numberERK14NimBLEConnInfo">
<span id="_CPPv3NK4espp13BleGattServer33get_connected_device_model_numberERK14NimBLEConnInfo"></span><span id="_CPPv2NK4espp13BleGattServer33get_connected_device_model_numberERK14NimBLEConnInfo"></span><span id="espp::BleGattServer::get_connected_device_model_number__NimBLEConnInfoCRC"></span><span class="target" id="classespp_1_1BleGattServer_1a720bafed24811202bf16cf8dcb0ea4f7"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_connected_device_model_number</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">NimBLEConnInfo</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">conn_info</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer33get_connected_device_model_numberERK14NimBLEConnInfo" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the connected device Model Number string </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method will connect to the device to read the characteristic. This may take some time if the device is not already connected. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The remote device may not expose a Device Information Service, in which case this method will return an empty optional. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>conn_info</strong> – The connection information for the device. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The connected device Model Number string. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer26get_connected_device_namesEv">
<span id="_CPPv3NK4espp13BleGattServer26get_connected_device_namesEv"></span><span id="_CPPv2NK4espp13BleGattServer26get_connected_device_namesEv"></span><span id="espp::BleGattServer::get_connected_device_namesC"></span><span class="target" id="classespp_1_1BleGattServer_1a7a460009ff7bbf24bc485c77c7bffc60"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_connected_device_names</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer26get_connected_device_namesEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the connected device names </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method will connect to each device to get the device name. This may take some time if there are many devices connected. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The connected device names as a vector of strings. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer25get_connected_device_rssiERK14NimBLEConnInfo">
<span id="_CPPv3NK4espp13BleGattServer25get_connected_device_rssiERK14NimBLEConnInfo"></span><span id="_CPPv2NK4espp13BleGattServer25get_connected_device_rssiERK14NimBLEConnInfo"></span><span id="espp::BleGattServer::get_connected_device_rssi__NimBLEConnInfoCRC"></span><span class="target" id="classespp_1_1BleGattServer_1aad73be0e110550e53c98ec668e803ec0"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_connected_device_rssi</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">NimBLEConnInfo</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">conn_info</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer25get_connected_device_rssiERK14NimBLEConnInfo" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the RSSI of the connected device </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>conn_info</strong> – The connection information for the device. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The RSSI of the connected device. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer33get_connected_devices_rssi_valuesEv">
<span id="_CPPv3NK4espp13BleGattServer33get_connected_devices_rssi_valuesEv"></span><span id="_CPPv2NK4espp13BleGattServer33get_connected_devices_rssi_valuesEv"></span><span id="espp::BleGattServer::get_connected_devices_rssi_valuesC"></span><span class="target" id="classespp_1_1BleGattServer_1a48981affd506099f1487879e2b12d38e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_connected_devices_rssi_values</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer33get_connected_devices_rssi_valuesEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the RSSI of the connected devices </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method will connect to each device to get the RSSI. This may take some time if there are many devices connected. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The RSSI of the connected devices as a vector. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer14disconnect_allEv">
<span id="_CPPv3NK4espp13BleGattServer14disconnect_allEv"></span><span id="_CPPv2NK4espp13BleGattServer14disconnect_allEv"></span><span id="espp::BleGattServer::disconnect_allC"></span><span class="target" id="classespp_1_1BleGattServer_1a3a6bf8223a7fe9ae818cd95788b19463"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">NimBLEAddress</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">disconnect_all</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer14disconnect_allEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Disconnect from all devices This method disconnects from all devices that are currently connected. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The Addresses of the devices that were disconnected from. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer10unpair_allEv">
<span id="_CPPv3N4espp13BleGattServer10unpair_allEv"></span><span id="_CPPv2N4espp13BleGattServer10unpair_allEv"></span><span id="espp::BleGattServer::unpair_all"></span><span class="target" id="classespp_1_1BleGattServer_1a813edb8e25810a61e462f14d3fbd3a7c"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">NimBLEAddress</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">unpair_all</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer10unpair_allEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Unpair all devices This method unpairs all devices that are currently paired. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The Addresses of the devices that were unpaired. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer8get_nameEv">
<span id="_CPPv3NK4espp13BleGattServer8get_nameEv"></span><span id="_CPPv2NK4espp13BleGattServer8get_nameEv"></span><span id="espp::BleGattServer::get_nameC"></span><span class="target" id="classespp_1_1BaseComponent_1ad3813fa0c9c026e217163c4e2fdfc4a2"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">get_name</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer8get_nameEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the name of the component </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the tag of the logger </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A const reference to the name of the component </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer11set_log_tagERKNSt11string_viewE">
<span id="_CPPv3N4espp13BleGattServer11set_log_tagERKNSt11string_viewE"></span><span id="_CPPv2N4espp13BleGattServer11set_log_tagERKNSt11string_viewE"></span><span id="espp::BleGattServer::set_log_tag__std::string_viewCR"></span><span class="target" id="classespp_1_1BaseComponent_1af83083445936081581ffbddd93634b90"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_log_tag</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string_view</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tag</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer11set_log_tagERKNSt11string_viewE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set the tag for the logger </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tag</strong> – The tag to use for the logger </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer13get_log_levelEv">
<span id="_CPPv3NK4espp13BleGattServer13get_log_levelEv"></span><span id="_CPPv2NK4espp13BleGattServer13get_log_levelEv"></span><span id="espp::BleGattServer::get_log_levelC"></span><span class="target" id="classespp_1_1BaseComponent_1a54f34a70b117486a7055e4a6f1d4d7a8"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">espp</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="../logger.html#_CPPv4N4espp6LoggerE" title="espp::Logger"><span class="n"><span class="pre">Logger</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="../logger.html#_CPPv4N4espp6Logger9VerbosityE" title="espp::Logger::Verbosity"><span class="n"><span class="pre">Verbosity</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_log_level</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer13get_log_levelEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the log level for the logger <div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../logger.html#classespp_1_1Logger_1ac6c63313236b0ae6ff44f3f94a6f99cb"><span class="std std-ref">Logger::Verbosity</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../logger.html#classespp_1_1Logger_1aa8c260085619fd42e17b92c41a638741"><span class="std std-ref">Logger::set_verbosity</span></a></p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The verbosity level of the logger </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer13set_log_levelEN4espp6Logger9VerbosityE">
<span id="_CPPv3N4espp13BleGattServer13set_log_levelEN4espp6Logger9VerbosityE"></span><span id="_CPPv2N4espp13BleGattServer13set_log_levelEN4espp6Logger9VerbosityE"></span><span id="espp::BleGattServer::set_log_level__espp::Logger::Verbosity"></span><span class="target" id="classespp_1_1BaseComponent_1a3159df4e466f93ebb6cca7e685d27243"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_log_level</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">espp</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="../logger.html#_CPPv4N4espp6LoggerE" title="espp::Logger"><span class="n"><span class="pre">Logger</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="../logger.html#_CPPv4N4espp6Logger9VerbosityE" title="espp::Logger::Verbosity"><span class="n"><span class="pre">Verbosity</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer13set_log_levelEN4espp6Logger9VerbosityE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set the log level for the logger <div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../logger.html#classespp_1_1Logger_1ac6c63313236b0ae6ff44f3f94a6f99cb"><span class="std std-ref">Logger::Verbosity</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../logger.html#classespp_1_1Logger_1aa8c260085619fd42e17b92c41a638741"><span class="std std-ref">Logger::set_verbosity</span></a></p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>level</strong> – The verbosity level to use for the logger </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer17set_log_verbosityEN4espp6Logger9VerbosityE">
<span id="_CPPv3N4espp13BleGattServer17set_log_verbosityEN4espp6Logger9VerbosityE"></span><span id="_CPPv2N4espp13BleGattServer17set_log_verbosityEN4espp6Logger9VerbosityE"></span><span id="espp::BleGattServer::set_log_verbosity__espp::Logger::Verbosity"></span><span class="target" id="classespp_1_1BaseComponent_1abb459bcd55b41471e201475fbf1a1b1f"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_log_verbosity</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">espp</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="../logger.html#_CPPv4N4espp6LoggerE" title="espp::Logger"><span class="n"><span class="pre">Logger</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="../logger.html#_CPPv4N4espp6Logger9VerbosityE" title="espp::Logger::Verbosity"><span class="n"><span class="pre">Verbosity</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">level</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer17set_log_verbosityEN4espp6Logger9VerbosityE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set the log verbosity for the logger <div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../ws_s3_touch.html#classespp_1_1BaseComponent_1a3159df4e466f93ebb6cca7e685d27243"><span class="std std-ref">set_log_level</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../logger.html#classespp_1_1Logger_1ac6c63313236b0ae6ff44f3f94a6f99cb"><span class="std std-ref">Logger::Verbosity</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../logger.html#classespp_1_1Logger_1aa8c260085619fd42e17b92c41a638741"><span class="std std-ref">Logger::set_verbosity</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a convenience method that calls set_log_level </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>level</strong> – The verbosity level to use for the logger </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4espp13BleGattServer17get_log_verbosityEv">
<span id="_CPPv3NK4espp13BleGattServer17get_log_verbosityEv"></span><span id="_CPPv2NK4espp13BleGattServer17get_log_verbosityEv"></span><span id="espp::BleGattServer::get_log_verbosityC"></span><span class="target" id="classespp_1_1BaseComponent_1ac9cda1ea5d5321040ca13a827057ff79"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">espp</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="../logger.html#_CPPv4N4espp6LoggerE" title="espp::Logger"><span class="n"><span class="pre">Logger</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="../logger.html#_CPPv4N4espp6Logger9VerbosityE" title="espp::Logger::Verbosity"><span class="n"><span class="pre">Verbosity</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_log_verbosity</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4espp13BleGattServer17get_log_verbosityEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the log verbosity for the logger <div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../ws_s3_touch.html#classespp_1_1BaseComponent_1a54f34a70b117486a7055e4a6f1d4d7a8"><span class="std std-ref">get_log_level</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../logger.html#classespp_1_1Logger_1ac6c63313236b0ae6ff44f3f94a6f99cb"><span class="std std-ref">Logger::Verbosity</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../logger.html#classespp_1_1Logger_1a6ed0028b750b3e4aae21d2ecb3670c55"><span class="std std-ref">Logger::get_verbosity</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a convenience method that calls get_log_level </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The verbosity level of the logger </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer18set_log_rate_limitENSt6chrono8durationIfEE">
<span id="_CPPv3N4espp13BleGattServer18set_log_rate_limitENSt6chrono8durationIfEE"></span><span id="_CPPv2N4espp13BleGattServer18set_log_rate_limitENSt6chrono8durationIfEE"></span><span id="espp::BleGattServer::set_log_rate_limit__std::chrono::duration:float:"></span><span class="target" id="classespp_1_1BaseComponent_1a8b95d7a8a87f22a989f3654a238774a0"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_log_rate_limit</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">chrono</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">duration</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rate_limit</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer18set_log_rate_limitENSt6chrono8durationIfEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set the rate limit for the logger <div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../logger.html#classespp_1_1Logger_1a9ce0c51e1bf43e63235c6ddf3280b15d"><span class="std std-ref">Logger::set_rate_limit</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only calls to the logger that have _rate_limit suffix will be rate limited </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rate_limit</strong> – The rate limit to use for the logger </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-static-functions">Public Static Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer20interval_ms_to_unitsE8uint16_t">
<span id="_CPPv3N4espp13BleGattServer20interval_ms_to_unitsE8uint16_t"></span><span id="_CPPv2N4espp13BleGattServer20interval_ms_to_unitsE8uint16_t"></span><span id="espp::BleGattServer::interval_ms_to_units__uint16_tCE"></span><span class="target" id="classespp_1_1BleGattServer_1a584a9788b08141aac73fc8149a07eeb0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">interval_ms_to_units</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">interval_ms</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer20interval_ms_to_unitsE8uint16_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Convert an interval in milliseconds to units of 0.625 ms. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>interval_ms</strong> – The interval in milliseconds. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The interval in units of 0.625 ms. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer20interval_units_to_msE8uint16_t">
<span id="_CPPv3N4espp13BleGattServer20interval_units_to_msE8uint16_t"></span><span id="_CPPv2N4espp13BleGattServer20interval_units_to_msE8uint16_t"></span><span id="espp::BleGattServer::interval_units_to_ms__uint16_tCE"></span><span class="target" id="classespp_1_1BleGattServer_1a94cbc08c066ab1ba6b42ebd0b06f4f46"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">interval_units_to_ms</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">interval_units</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer20interval_units_to_msE8uint16_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Convert an interval in units of 0.625 ms to milliseconds. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>interval_units</strong> – The interval in units of 0.625 ms. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The interval in milliseconds. </p>
</dd>
</dl>
</dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer21AdvertisingParametersE">
<span id="_CPPv3N4espp13BleGattServer21AdvertisingParametersE"></span><span id="_CPPv2N4espp13BleGattServer21AdvertisingParametersE"></span><span id="espp::BleGattServer::AdvertisingParameters"></span><span class="target" id="structespp_1_1BleGattServer_1_1AdvertisingParameters"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AdvertisingParameters</span></span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer21AdvertisingParametersE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Advertising parameters for the device. This struct contains the advertising parameters for the device. </p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#classespp_1_1BleGattServer_1a0b0560887c093b1d62e695dbbc13200a"><span class="std std-ref">start_advertising</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This struct is only available when CONFIG_BT_NIMBLE_EXT_ADV is not enabled, ane legacy advertising is used. Otherwise, use the NimBLEExtAdvertisement class. </p>
</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer21AdvertisingParameters11connectableE">
<span id="_CPPv3N4espp13BleGattServer21AdvertisingParameters11connectableE"></span><span id="_CPPv2N4espp13BleGattServer21AdvertisingParameters11connectableE"></span><span id="espp::BleGattServer::AdvertisingParameters::connectable__b"></span><span class="target" id="structespp_1_1BleGattServer_1_1AdvertisingParameters_1a16438703fd2e21266a8ef8c6d228c4e0"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">connectable</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer21AdvertisingParameters11connectableE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Whether the device should be connectable. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer21AdvertisingParameters15min_interval_msE">
<span id="_CPPv3N4espp13BleGattServer21AdvertisingParameters15min_interval_msE"></span><span id="_CPPv2N4espp13BleGattServer21AdvertisingParameters15min_interval_msE"></span><span id="espp::BleGattServer::AdvertisingParameters::min_interval_ms__uint16_t"></span><span class="target" id="structespp_1_1BleGattServer_1_1AdvertisingParameters_1a901c10e8733c9a5d28d0bc214cd6116d"></span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">min_interval_ms</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">20</span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer21AdvertisingParameters15min_interval_msE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Minimum advertising interval. NOTE: this is in milliseconds, but will be converted to units of 0.625 ms. If the value is not a multiple of 0.625 ms, it will be rounded to the nearest multiple and a log message will be printed. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer21AdvertisingParameters15max_interval_msE">
<span id="_CPPv3N4espp13BleGattServer21AdvertisingParameters15max_interval_msE"></span><span id="_CPPv2N4espp13BleGattServer21AdvertisingParameters15max_interval_msE"></span><span id="espp::BleGattServer::AdvertisingParameters::max_interval_ms__uint16_t"></span><span class="target" id="structespp_1_1BleGattServer_1_1AdvertisingParameters_1a6011ced26e444eaf307f73978eedf45d"></span><span class="n"><span class="pre">uint16_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">max_interval_ms</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">40</span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer21AdvertisingParameters15max_interval_msE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Maximum advertising interval. NOTE: this is in milliseconds, but will be converted to units of 0.625 ms. If the value is not a multiple of 0.625 ms, it will be rounded to the nearest multiple and a log message will be printed. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer21AdvertisingParameters16include_tx_powerE">
<span id="_CPPv3N4espp13BleGattServer21AdvertisingParameters16include_tx_powerE"></span><span id="_CPPv2N4espp13BleGattServer21AdvertisingParameters16include_tx_powerE"></span><span id="espp::BleGattServer::AdvertisingParameters::include_tx_power__b"></span><span class="target" id="structespp_1_1BleGattServer_1_1AdvertisingParameters_1a1577d7a65389e2390862fab3c2fbc11f"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">include_tx_power</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer21AdvertisingParameters16include_tx_powerE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Whether to include the TX power level. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer21AdvertisingParameters13scan_responseE">
<span id="_CPPv3N4espp13BleGattServer21AdvertisingParameters13scan_responseE"></span><span id="_CPPv2N4espp13BleGattServer21AdvertisingParameters13scan_responseE"></span><span id="espp::BleGattServer::AdvertisingParameters::scan_response__b"></span><span class="target" id="structespp_1_1BleGattServer_1_1AdvertisingParameters_1a8c0ca0dd411715ebeed20f52403431f0"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scan_response</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer21AdvertisingParameters13scan_responseE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Whether the device should include scan response data. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer21AdvertisingParameters22scan_request_whitelistE">
<span id="_CPPv3N4espp13BleGattServer21AdvertisingParameters22scan_request_whitelistE"></span><span id="_CPPv2N4espp13BleGattServer21AdvertisingParameters22scan_request_whitelistE"></span><span id="espp::BleGattServer::AdvertisingParameters::scan_request_whitelist__b"></span><span class="target" id="structespp_1_1BleGattServer_1_1AdvertisingParameters_1a17803fd18d05fdde776b5501a197cd14"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scan_request_whitelist</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer21AdvertisingParameters22scan_request_whitelistE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Whether the device should use the white list when scanning </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer21AdvertisingParameters17connect_whitelistE">
<span id="_CPPv3N4espp13BleGattServer21AdvertisingParameters17connect_whitelistE"></span><span id="_CPPv2N4espp13BleGattServer21AdvertisingParameters17connect_whitelistE"></span><span id="espp::BleGattServer::AdvertisingParameters::connect_whitelist__b"></span><span class="target" id="structespp_1_1BleGattServer_1_1AdvertisingParameters_1a640904159a6ca8fb86895d73e5c470f8"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">connect_whitelist</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer21AdvertisingParameters17connect_whitelistE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Whether the device should use the white list when connecting </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer21AdvertisingParameters11duration_msE">
<span id="_CPPv3N4espp13BleGattServer21AdvertisingParameters11duration_msE"></span><span id="_CPPv2N4espp13BleGattServer21AdvertisingParameters11duration_msE"></span><span id="espp::BleGattServer::AdvertisingParameters::duration_ms__uint32_t"></span><span class="target" id="structespp_1_1BleGattServer_1_1AdvertisingParameters_1a2a42fd63f5d4756da5b313715525796f"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">duration_ms</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer21AdvertisingParameters11duration_msE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Advertising duration (in ms, 0 for no timeout) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer21AdvertisingParameters16directed_addressE">
<span id="_CPPv3N4espp13BleGattServer21AdvertisingParameters16directed_addressE"></span><span id="_CPPv2N4espp13BleGattServer21AdvertisingParameters16directed_addressE"></span><span id="espp::BleGattServer::AdvertisingParameters::directed_address__NimBLEAddressP"></span><span class="target" id="structespp_1_1BleGattServer_1_1AdvertisingParameters_1a310db6bc56a0d230109f116df2153a73"></span><span class="n"><span class="pre">NimBLEAddress</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">directed_address</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer21AdvertisingParameters16directed_addressE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Address to direct advertising to, if any. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer9CallbacksE">
<span id="_CPPv3N4espp13BleGattServer9CallbacksE"></span><span id="_CPPv2N4espp13BleGattServer9CallbacksE"></span><span id="espp::BleGattServer::Callbacks"></span><span class="target" id="structespp_1_1BleGattServer_1_1Callbacks"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Callbacks</span></span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer9CallbacksE" title="Permalink to this definition"></a><br /></dt>
<dd><p><a class="reference internal" href="#structespp_1_1BleGattServer_1_1Callbacks"><span class="std std-ref">Callbacks</span></a> for the GATT server. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer9Callbacks16connect_callbackE">
<span id="_CPPv3N4espp13BleGattServer9Callbacks16connect_callbackE"></span><span id="_CPPv2N4espp13BleGattServer9Callbacks16connect_callbackE"></span><span id="espp::BleGattServer::Callbacks::connect_callback__connect_callback_t"></span><span class="target" id="structespp_1_1BleGattServer_1_1Callbacks_1aa85a3e7de55f854ce6e5cffad0cdea91"></span><a class="reference internal" href="#_CPPv4N4espp13BleGattServer18connect_callback_tE" title="espp::BleGattServer::connect_callback_t"><span class="n"><span class="pre">connect_callback_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">connect_callback</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer9Callbacks16connect_callbackE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Callback for when a device connects to the GATT server. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer9Callbacks19disconnect_callbackE">
<span id="_CPPv3N4espp13BleGattServer9Callbacks19disconnect_callbackE"></span><span id="_CPPv2N4espp13BleGattServer9Callbacks19disconnect_callbackE"></span><span id="espp::BleGattServer::Callbacks::disconnect_callback__disconnect_callback_t"></span><span class="target" id="structespp_1_1BleGattServer_1_1Callbacks_1aa778c1b30cf0dc01595094e41ead0561"></span><a class="reference internal" href="#_CPPv4N4espp13BleGattServer21disconnect_callback_tE" title="espp::BleGattServer::disconnect_callback_t"><span class="n"><span class="pre">disconnect_callback_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">disconnect_callback</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer9Callbacks19disconnect_callbackE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Callback for when a device disconnects from the GATT server. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer9Callbacks32authentication_complete_callbackE">
<span id="_CPPv3N4espp13BleGattServer9Callbacks32authentication_complete_callbackE"></span><span id="_CPPv2N4espp13BleGattServer9Callbacks32authentication_complete_callbackE"></span><span id="espp::BleGattServer::Callbacks::authentication_complete_callback__authentication_complete_callback_t"></span><span class="target" id="structespp_1_1BleGattServer_1_1Callbacks_1ad6086bd8af2ec7b721ee8c8641e8f29a"></span><a class="reference internal" href="#_CPPv4N4espp13BleGattServer34authentication_complete_callback_tE" title="espp::BleGattServer::authentication_complete_callback_t"><span class="n"><span class="pre">authentication_complete_callback_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">authentication_complete_callback</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer9Callbacks32authentication_complete_callbackE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Callback for when a device completes authentication. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer9Callbacks20get_passkey_callbackE">
<span id="_CPPv3N4espp13BleGattServer9Callbacks20get_passkey_callbackE"></span><span id="_CPPv2N4espp13BleGattServer9Callbacks20get_passkey_callbackE"></span><span id="espp::BleGattServer::Callbacks::get_passkey_callback__get_passkey_callback_t"></span><span class="target" id="structespp_1_1BleGattServer_1_1Callbacks_1afac3f601deb4ec0d569abe9a51d79e75"></span><a class="reference internal" href="#_CPPv4N4espp13BleGattServer22get_passkey_callback_tE" title="espp::BleGattServer::get_passkey_callback_t"><span class="n"><span class="pre">get_passkey_callback_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_passkey_callback</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer9Callbacks20get_passkey_callbackE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Callback for getting the passkey. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If not provided, will simply return NimBLEDevice::getSecurityPasskey(). </p>
</div>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer9Callbacks24confirm_passkey_callbackE">
<span id="_CPPv3N4espp13BleGattServer9Callbacks24confirm_passkey_callbackE"></span><span id="_CPPv2N4espp13BleGattServer9Callbacks24confirm_passkey_callbackE"></span><span id="espp::BleGattServer::Callbacks::confirm_passkey_callback__confirm_passkey_callback_t"></span><span class="target" id="structespp_1_1BleGattServer_1_1Callbacks_1aa6de30987326e511c84d15286d1bc5dc"></span><a class="reference internal" href="#_CPPv4N4espp13BleGattServer26confirm_passkey_callback_tE" title="espp::BleGattServer::confirm_passkey_callback_t"><span class="n"><span class="pre">confirm_passkey_callback_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">confirm_passkey_callback</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer9Callbacks24confirm_passkey_callbackE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Callback for confirming the passkey. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Within this function or some point after this call, the user should call NimBLEDevice::injectConfirmPIN(conn_info, true/false) to confirm or reject the passkey. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If not provided, will simply call NimBLEDevice::injectConfirmPIN(conn_info, passkey == NimBLEDevice::getSecurityPasskey()). </p>
</div>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer9Callbacks31advertisement_complete_callbackE">
<span id="_CPPv3N4espp13BleGattServer9Callbacks31advertisement_complete_callbackE"></span><span id="_CPPv2N4espp13BleGattServer9Callbacks31advertisement_complete_callbackE"></span><span id="espp::BleGattServer::Callbacks::advertisement_complete_callback__advertisement_complete_callback_t"></span><span class="target" id="structespp_1_1BleGattServer_1_1Callbacks_1aad75eb35cdabe58c0a96f00533cc48aa"></span><a class="reference internal" href="#_CPPv4N4espp13BleGattServer33advertisement_complete_callback_tE" title="espp::BleGattServer::advertisement_complete_callback_t"><span class="n"><span class="pre">advertisement_complete_callback_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">advertisement_complete_callback</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer9Callbacks31advertisement_complete_callbackE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Callback for when advertising is complete. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is called when advertising is complete, not when the device is actually advertising. It will not be called if the advertisement duration is 0 (i.e. no timeout) </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is only available when CONFIG_BT_NIMBLE_EXT_ADV is not enabled. </p>
</div>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer9Callbacks30advertisement_stopped_callbackE">
<span id="_CPPv3N4espp13BleGattServer9Callbacks30advertisement_stopped_callbackE"></span><span id="_CPPv2N4espp13BleGattServer9Callbacks30advertisement_stopped_callbackE"></span><span id="espp::BleGattServer::Callbacks::advertisement_stopped_callback__advertisement_stopped_callback_t"></span><span class="target" id="structespp_1_1BleGattServer_1_1Callbacks_1acd7ea33506fc9aea20b2cd4aa10939a2"></span><a class="reference internal" href="#_CPPv4N4espp13BleGattServer32advertisement_stopped_callback_tE" title="espp::BleGattServer::advertisement_stopped_callback_t"><span class="n"><span class="pre">advertisement_stopped_callback_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">advertisement_stopped_callback</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer9Callbacks30advertisement_stopped_callbackE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Callback for when advertising is stopped. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is only available when CONFIG_BT_NIMBLE_EXT_ADV is enabled. </p>
</div>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer9Callbacks21scan_request_callbackE">
<span id="_CPPv3N4espp13BleGattServer9Callbacks21scan_request_callbackE"></span><span id="_CPPv2N4espp13BleGattServer9Callbacks21scan_request_callbackE"></span><span id="espp::BleGattServer::Callbacks::scan_request_callback__scan_request_callback_t"></span><span class="target" id="structespp_1_1BleGattServer_1_1Callbacks_1a314e241f2851e4a3346c0577e031db80"></span><a class="reference internal" href="#_CPPv4N4espp13BleGattServer23scan_request_callback_tE" title="espp::BleGattServer::scan_request_callback_t"><span class="n"><span class="pre">scan_request_callback_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scan_request_callback</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer9Callbacks21scan_request_callbackE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Callback for when a scan request is received. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is only available when CONFIG_BT_NIMBLE_EXT_ADV is enabled. </p>
</div>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer6ConfigE">
<span id="_CPPv3N4espp13BleGattServer6ConfigE"></span><span id="_CPPv2N4espp13BleGattServer6ConfigE"></span><span id="espp::BleGattServer::Config"></span><span class="target" id="structespp_1_1BleGattServer_1_1Config"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Config</span></span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer6ConfigE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Configuration for the GATT server. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer6Config9callbacksE">
<span id="_CPPv3N4espp13BleGattServer6Config9callbacksE"></span><span id="_CPPv2N4espp13BleGattServer6Config9callbacksE"></span><span id="espp::BleGattServer::Config::callbacks__Callbacks"></span><span class="target" id="structespp_1_1BleGattServer_1_1Config_1a7aac74e19fbee663b3ddfa8f5dcb5763"></span><a class="reference internal" href="#_CPPv4N4espp13BleGattServer9CallbacksE" title="espp::BleGattServer::Callbacks"><span class="n"><span class="pre">Callbacks</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">callbacks</span></span></span><a class="headerlink" href="#_CPPv4N4espp13BleGattServer6Config9callbacksE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The callbacks for the GATT server. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4espp13BleGattServer6Config9log_levelE">
<span id="_CPPv3N4espp13BleGattServer6Config9log_levelE"></span><span id="_CPPv2N4espp13BleGattServer6Config9log_levelE"></span><span id="espp::BleGattServer::Config::log_level__espp::Logger::Verbosity"></span><span class="target" id="structespp_1_1BleGattServer_1_1Config_1a708eccc87b69d6ddca43f6b56a19f95a"></span><span class="n"><span class="pre">espp</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="../logger.html#_CPPv4N4espp6LoggerE" title="espp::Logger"><span class="n"><span class="pre">Logger</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="../logger.html#_CPPv4N4espp6Logger9VerbosityE" title="espp::Logger::Verbosity"><span class="n"><span class="pre">Verbosity</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">log_level</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">espp</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="../logger.html#_CPPv4N4espp6LoggerE" title="espp::Logger"><span class="n"><span class="pre">Logger</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="../logger.html#_CPPv4N4espp6Logger9VerbosityE" title="espp::Logger::Verbosity"><span class="n"><span class="pre">Verbosity</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="../logger.html#_CPPv4N4espp6Logger9Verbosity4WARNE" title="espp::Logger::Verbosity::WARN"><span class="n"><span class="pre">WARN</span></span></a><a class="headerlink" href="#_CPPv4N4espp13BleGattServer6Config9log_levelE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The verbosity of the logger_. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
<section id="id2">
<h3>Header File<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/esp-cpp/espp/blob/32e8215e/components/ble_gatt_server/include/ble_gatt_server_callbacks.hpp">components/ble_gatt_server/include/ble_gatt_server_callbacks.hpp</a></p></li>
</ul>
</section>
<section id="id3">
<h3>Classes<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h3>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N4espp22BleGattServerCallbacksE">
<span id="_CPPv3N4espp22BleGattServerCallbacksE"></span><span id="_CPPv2N4espp22BleGattServerCallbacksE"></span><span id="espp::BleGattServerCallbacks"></span><span class="target" id="classespp_1_1BleGattServerCallbacks"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BleGattServerCallbacks</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">NimBLEServerCallbacks</span></span><a class="headerlink" href="#_CPPv4N4espp22BleGattServerCallbacksE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Class for handling GATT server callbacks, as required by NimBLE </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class is not intended to be used directly by the user </p>
</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N4espp33BleGattServerAdvertisingCallbacksE">
<span id="_CPPv3N4espp33BleGattServerAdvertisingCallbacksE"></span><span id="_CPPv2N4espp33BleGattServerAdvertisingCallbacksE"></span><span id="espp::BleGattServerAdvertisingCallbacks"></span><span class="target" id="classespp_1_1BleGattServerAdvertisingCallbacks"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BleGattServerAdvertisingCallbacks</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">NimBLEExtAdvertisingCallbacks</span></span><a class="headerlink" href="#_CPPv4N4espp33BleGattServerAdvertisingCallbacksE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Class for handling GATT server advertising callbacks, as required by NimBLE </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class is not intended to be used directly by the user </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class is only available if CONFIG_BT_NIMBLE_EXT_ADV is enabled </p>
</div>
</dd></dl>

</section>
<section id="id4">
<h3>Header File<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/esp-cpp/espp/blob/32e8215e/components/ble_gatt_server/include/ble_gatt_server_menu.hpp">components/ble_gatt_server/include/ble_gatt_server_menu.hpp</a></p></li>
</ul>
</section>
<section id="id5">
<h3>Classes<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h3>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N4espp17BleGattServerMenuE">
<span id="_CPPv3N4espp17BleGattServerMenuE"></span><span id="_CPPv2N4espp17BleGattServerMenuE"></span><span id="espp::BleGattServerMenu"></span><span class="target" id="classespp_1_1BleGattServerMenu"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BleGattServerMenu</span></span></span><a class="headerlink" href="#_CPPv4N4espp17BleGattServerMenuE" title="Permalink to this definition"></a><br /></dt>
<dd><p>A CLI menu for interacting with <a class="reference internal" href="#classespp_1_1BleGattServer"><span class="std std-ref">BleGattServer</span></a>. </p>
<p>This class provides a CLI menu for interacting with a <a class="reference internal" href="#classespp_1_1BleGattServer"><span class="std std-ref">BleGattServer</span></a>. It provides options for setting the log verbosity, viewing the paired devices, viewing the connected devices, disconnecting devices, and more.</p>
<section id="classespp_1_1BleGattServerMenu_1ble_gatt_server_menu_ex1">
<h4>Example<a class="headerlink" href="#classespp_1_1BleGattServerMenu_1ble_gatt_server_menu_ex1" title="Permalink to this heading"></a></h4>
<div class="highlight-cpp notranslate" id="classespp_1_1BleGattServerMenu_1ble_gatt_server_menu_ex1"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1">// NOTE: esp-nimble-cpp already depends on nvs_flash and initializes</span>
<span class="w">    </span><span class="c1">//       nvs_flash in the NimBLEDevice::init(), so we don&#39;t have to do that</span>
<span class="w">    </span><span class="c1">//       to store bonding info</span>

<span class="w">    </span><span class="c1">// create the GATT server</span>
<span class="w">    </span><span class="n">espp</span><span class="o">::</span><span class="n">BleGattServer</span><span class="w"> </span><span class="n">ble_gatt_server</span><span class="p">;</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">device_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Espp BLE GATT Server&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">set_log_level</span><span class="p">(</span><span class="n">espp</span><span class="o">::</span><span class="n">Logger</span><span class="o">::</span><span class="n">Verbosity</span><span class="o">::</span><span class="n">INFO</span><span class="p">);</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">set_callbacks</span><span class="p">({</span>
<span class="w">        </span><span class="p">.</span><span class="n">connect_callback</span><span class="w"> </span><span class="o">=</span>
<span class="w">            </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="n">NimBLEConnInfo</span><span class="w"> </span><span class="o">&amp;</span><span class="n">conn_info</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Device connected&quot;</span><span class="p">);</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="p">.</span><span class="n">disconnect_callback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">conn_info</span><span class="p">,</span>
<span class="w">                                   </span><span class="k">auto</span><span class="w"> </span><span class="n">reason</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Device disconnected: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">reason</span><span class="p">);</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="p">.</span><span class="n">authentication_complete_callback</span><span class="w"> </span><span class="o">=</span>
<span class="w">            </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="n">NimBLEConnInfo</span><span class="w"> </span><span class="o">&amp;</span><span class="n">conn_info</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Device authenticated&quot;</span><span class="p">);</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="c1">// NOTE: this is optional, if you don&#39;t provide this callback, it will</span>
<span class="w">        </span><span class="c1">// perform the exactly function as below:</span>
<span class="w">        </span><span class="p">.</span><span class="n">get_passkey_callback</span><span class="w"> </span><span class="o">=</span>
<span class="w">            </span><span class="p">[</span><span class="o">&amp;</span><span class="p">]()</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Getting passkey&quot;</span><span class="p">);</span>
<span class="w">              </span><span class="k">return</span><span class="w"> </span><span class="n">NimBLEDevice</span><span class="o">::</span><span class="n">getSecurityPasskey</span><span class="p">();</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="c1">// NOTE: this is optional, if you don&#39;t provide this callback, it will</span>
<span class="w">        </span><span class="c1">// perform the exactly function as below:</span>
<span class="w">        </span><span class="p">.</span><span class="n">confirm_passkey_callback</span><span class="w"> </span><span class="o">=</span>
<span class="w">            </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="n">NimBLEConnInfo</span><span class="w"> </span><span class="o">&amp;</span><span class="n">conn_info</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">passkey</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Confirming passkey: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">passkey</span><span class="p">);</span>
<span class="w">              </span><span class="n">NimBLEDevice</span><span class="o">::</span><span class="n">injectConfirmPasskey</span><span class="p">(</span><span class="n">conn_info</span><span class="p">,</span>
<span class="w">                                                 </span><span class="n">passkey</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NimBLEDevice</span><span class="o">::</span><span class="n">getSecurityPasskey</span><span class="p">());</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">device_name</span><span class="p">);</span>
<span class="cp">#if !CONFIG_BT_NIMBLE_EXT_ADV</span>
<span class="w">    </span><span class="c1">// extended advertisement does not support automatically advertising on</span>
<span class="w">    </span><span class="c1">// disconnect</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">set_advertise_on_disconnect</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
<span class="cp">#endif</span>

<span class="w">    </span><span class="c1">// let&#39;s configure the security</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">bonding</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">mitm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">secure_connections</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">set_security</span><span class="p">(</span><span class="n">bonding</span><span class="p">,</span><span class="w"> </span><span class="n">mitm</span><span class="p">,</span><span class="w"> </span><span class="n">secure_connections</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// and some i/o and key config</span>
<span class="w">    </span><span class="n">NimBLEDevice</span><span class="o">::</span><span class="n">setSecurityPasskey</span><span class="p">(</span><span class="mi">123456</span><span class="p">);</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">set_io_capabilities</span><span class="p">(</span><span class="n">BLE_HS_IO_NO_INPUT_OUTPUT</span><span class="p">);</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">set_init_key_distribution</span><span class="p">(</span><span class="n">BLE_SM_PAIR_KEY_DIST_ENC</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">BLE_SM_PAIR_KEY_DIST_ID</span><span class="p">);</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">set_resp_key_distribution</span><span class="p">(</span><span class="n">BLE_SM_PAIR_KEY_DIST_ENC</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">BLE_SM_PAIR_KEY_DIST_ID</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// you can create a service and add it to the server using</span>
<span class="w">    </span><span class="c1">// ble_gatt_server.server().addService()</span>

<span class="w">    </span><span class="c1">// now start the services</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">start_services</span><span class="p">();</span><span class="w"> </span><span class="c1">// starts the device info service and battery service</span>
<span class="w">    </span><span class="c1">// NOTE: we could also directly start them ourselves if we wanted to</span>
<span class="w">    </span><span class="c1">//      control the order of starting the services</span>
<span class="w">    </span><span class="c1">// e.g.:</span>
<span class="w">    </span><span class="c1">// ble_gatt_server.battery_service().start();</span>
<span class="w">    </span><span class="c1">// ble_gatt_server.device_info_service().start();</span>

<span class="w">    </span><span class="c1">// now start the gatt server</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">start</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// let&#39;s set some of the service data</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">battery_service</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">battery_service</span><span class="p">();</span>
<span class="w">    </span><span class="n">battery_service</span><span class="p">.</span><span class="n">set_battery_level</span><span class="p">(</span><span class="mi">99</span><span class="p">);</span>

<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">device_info_service</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">device_info_service</span><span class="p">();</span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">vendor_source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x01</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">vid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xCafe</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">pid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xFace</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">product_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x0100</span><span class="p">;</span>
<span class="w">    </span><span class="n">device_info_service</span><span class="p">.</span><span class="n">set_pnp_id</span><span class="p">(</span><span class="n">vendor_source</span><span class="p">,</span><span class="w"> </span><span class="n">vid</span><span class="p">,</span><span class="w"> </span><span class="n">pid</span><span class="p">,</span><span class="w"> </span><span class="n">product_version</span><span class="p">);</span>
<span class="w">    </span><span class="n">device_info_service</span><span class="p">.</span><span class="n">set_manufacturer_name</span><span class="p">(</span><span class="s">&quot;ESP-CPP&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">device_info_service</span><span class="p">.</span><span class="n">set_model_number</span><span class="p">(</span><span class="s">&quot;esp-ble-01&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">device_info_service</span><span class="p">.</span><span class="n">set_serial_number</span><span class="p">(</span><span class="s">&quot;1234567890&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">device_info_service</span><span class="p">.</span><span class="n">set_software_version</span><span class="p">(</span><span class="s">&quot;1.0.0&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">device_info_service</span><span class="p">.</span><span class="n">set_firmware_version</span><span class="p">(</span><span class="s">&quot;1.0.0&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">device_info_service</span><span class="p">.</span><span class="n">set_hardware_version</span><span class="p">(</span><span class="s">&quot;1.0.0&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// set the advertising data</span>
<span class="w">    </span><span class="n">espp</span><span class="o">::</span><span class="n">BleGattServer</span><span class="o">::</span><span class="n">AdvertisedData</span><span class="w"> </span><span class="n">adv_data</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// uint8_t flags = BLE_HS_ADV_F_DISC_LTD;</span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">flags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BLE_HS_ADV_F_DISC_GEN</span><span class="p">;</span>
<span class="w">    </span><span class="n">adv_data</span><span class="p">.</span><span class="n">setFlags</span><span class="p">(</span><span class="n">flags</span><span class="p">);</span>
<span class="w">    </span><span class="n">adv_data</span><span class="p">.</span><span class="n">setName</span><span class="p">(</span><span class="n">device_name</span><span class="p">);</span>
<span class="w">    </span><span class="n">adv_data</span><span class="p">.</span><span class="n">setAppearance</span><span class="p">((</span><span class="kt">uint16_t</span><span class="p">)</span><span class="n">espp</span><span class="o">::</span><span class="n">BleAppearance</span><span class="o">::</span><span class="n">GENERIC_COMPUTER</span><span class="p">);</span>
<span class="w">    </span><span class="n">adv_data</span><span class="p">.</span><span class="n">addTxPower</span><span class="p">();</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">set_advertisement_data</span><span class="p">(</span><span class="n">adv_data</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// let&#39;s test and use the BLE menu (CLI)</span>
<span class="w">    </span><span class="c1">// turn off some of the logs so that it doesn&#39;t clutter up the CLI</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">set_log_level</span><span class="p">(</span><span class="n">espp</span><span class="o">::</span><span class="n">Logger</span><span class="o">::</span><span class="n">Verbosity</span><span class="o">::</span><span class="n">WARN</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// and make the CLI</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">ble_menu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">espp</span><span class="o">::</span><span class="n">BleGattServerMenu</span><span class="p">(</span><span class="n">ble_gatt_server</span><span class="p">);</span>
<span class="w">    </span><span class="n">cli</span><span class="o">::</span><span class="n">SetColor</span><span class="p">();</span>
<span class="w">    </span><span class="n">cli</span><span class="o">::</span><span class="n">Cli</span><span class="w"> </span><span class="nf">cli</span><span class="p">(</span><span class="n">ble_menu</span><span class="p">.</span><span class="n">get</span><span class="p">());</span>
<span class="w">    </span><span class="n">cli</span><span class="p">.</span><span class="n">ExitAction</span><span class="p">([](</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Goodbye and thanks for all the fish.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">});</span>

<span class="w">    </span><span class="n">espp</span><span class="o">::</span><span class="n">Cli</span><span class="w"> </span><span class="nf">input</span><span class="p">(</span><span class="n">cli</span><span class="p">);</span>
<span class="w">    </span><span class="n">input</span><span class="p">.</span><span class="n">SetInputHistorySize</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="w">    </span><span class="n">input</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span><span class="w"> </span><span class="c1">// this will not return until the user enters the `exit` command.</span>

<span class="w">    </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Menu has finished, starting advertising&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// The menu has finished, so let&#39;s go into a loop to keep the device running</span>
<span class="w">    </span><span class="c1">// now lets start advertising</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">start_advertising</span><span class="p">();</span>

<span class="w">    </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Waiting for connection...&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// now lets update the battery level every second for a little while</span>
<span class="w">    </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">battery_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">99</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">was_connected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">can_exit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">num_seconds_to_wait</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">loop_start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">steady_clock</span><span class="o">::</span><span class="n">now</span><span class="p">();</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">steady_clock</span><span class="o">::</span><span class="n">now</span><span class="p">();</span>

<span class="w">      </span><span class="c1">// if we are now connected, but were not, then get the services</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">is_connected</span><span class="p">()</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">was_connected</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">connected_device_infos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">get_connected_device_infos</span><span class="p">();</span>
<span class="w">        </span><span class="c1">// check to make sure the first connection has bonded at least.</span>
<span class="w">        </span><span class="c1">//</span>
<span class="w">        </span><span class="c1">// NOTE: if we are not bonded, then the name that will be read out will be</span>
<span class="w">        </span><span class="c1">// generic, such as &quot;iPhone&quot;. If we are bonded, then the name will be the</span>
<span class="w">        </span><span class="c1">// actual device name, such as &quot;iPhone 14 Plus William&quot;.</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">first_device</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">connected_device_infos</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">first_device</span><span class="p">.</span><span class="n">isBonded</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="c1">// if it was, mark connected and print all the device infos</span>
<span class="w">          </span><span class="n">was_connected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">          </span><span class="n">can_exit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">          </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Connected devices: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">connected_device_infos</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
<span class="w">          </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">info</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">connected_device_infos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">auto</span><span class="w"> </span><span class="n">rssi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">get_connected_device_rssi</span><span class="p">(</span><span class="n">info</span><span class="p">);</span>
<span class="w">            </span><span class="k">auto</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">get_connected_device_name</span><span class="p">(</span><span class="n">info</span><span class="p">);</span>
<span class="w">            </span><span class="k">auto</span><span class="w"> </span><span class="n">mfg_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">get_connected_device_manufacturer_name</span><span class="p">(</span><span class="n">info</span><span class="p">);</span>
<span class="w">            </span><span class="k">auto</span><span class="w"> </span><span class="n">model_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">get_connected_device_model_number</span><span class="p">(</span><span class="n">info</span><span class="p">);</span>
<span class="w">            </span><span class="k">auto</span><span class="w"> </span><span class="n">pnp_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">get_connected_device_pnp_id</span><span class="p">(</span><span class="n">info</span><span class="p">);</span>
<span class="w">            </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;            RSSI:  {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">rssi</span><span class="p">);</span>
<span class="w">            </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;            Name:  {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<span class="w">            </span><span class="c1">// NOTE: these are optionals, so they may not be set</span>
<span class="w">            </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;            Mfg:   {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">mfg_name</span><span class="p">);</span>
<span class="w">            </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;            Model: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">model_number</span><span class="p">);</span>
<span class="w">            </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;            PnP:   {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pnp_id</span><span class="p">);</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">was_connected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">        </span><span class="n">can_exit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">is_connected</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">was_connected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">can_exit</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;No longer connected, exiting&quot;</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">is_connected</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">logger</span><span class="p">.</span><span class="n">move_up</span><span class="p">();</span>
<span class="w">        </span><span class="n">logger</span><span class="p">.</span><span class="n">clear_line</span><span class="p">();</span>
<span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">steady_clock</span><span class="o">::</span><span class="n">now</span><span class="p">();</span>
<span class="w">        </span><span class="k">auto</span><span class="w"> </span><span class="n">elapsed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">duration_cast</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">seconds</span><span class="o">&gt;</span><span class="p">(</span><span class="n">now</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">loop_start</span><span class="p">);</span>
<span class="w">        </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Waiting for connection... {}s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">num_seconds_to_wait</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">elapsed</span><span class="p">.</span><span class="n">count</span><span class="p">());</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">elapsed</span><span class="p">.</span><span class="n">count</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">num_seconds_to_wait</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="n">logger</span><span class="p">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;No connection, exiting&quot;</span><span class="p">);</span>
<span class="w">          </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c1">// sleep</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">this_thread</span><span class="o">::</span><span class="n">sleep_until</span><span class="p">(</span><span class="n">start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">100</span><span class="n">ms</span><span class="p">);</span>
<span class="w">        </span><span class="k">continue</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>

<span class="w">      </span><span class="c1">// update the battery level</span>
<span class="w">      </span><span class="n">battery_service</span><span class="p">.</span><span class="n">set_battery_level</span><span class="p">(</span><span class="n">battery_level</span><span class="p">);</span>
<span class="w">      </span><span class="n">battery_level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">battery_level</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="w">      </span><span class="c1">// sleep</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">this_thread</span><span class="o">::</span><span class="n">sleep_until</span><span class="p">(</span><span class="n">start</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">100</span><span class="n">ms</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// we are done, so stop the server and deinit the BLE stack. NOTE: this will</span>
<span class="w">    </span><span class="c1">// automatically be called by ~BleGattServer(), but we call it here to show</span>
<span class="w">    </span><span class="c1">// manual control and to test calling it multiple times since the destructor</span>
<span class="w">    </span><span class="c1">// will be called immediately after this block ends</span>
<span class="w">    </span><span class="n">ble_gatt_server</span><span class="p">.</span><span class="n">deinit</span><span class="p">();</span>
</pre></div>
</div>
</section>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp17BleGattServerMenu17BleGattServerMenuENSt17reference_wrapperIN4espp13BleGattServerEEE">
<span id="_CPPv3N4espp17BleGattServerMenu17BleGattServerMenuENSt17reference_wrapperIN4espp13BleGattServerEEE"></span><span id="_CPPv2N4espp17BleGattServerMenu17BleGattServerMenuENSt17reference_wrapperIN4espp13BleGattServerEEE"></span><span id="espp::BleGattServerMenu::BleGattServerMenu__std::reference_wrapper:espp::BleGattServer:"></span><span class="target" id="classespp_1_1BleGattServerMenu_1a4e2e71b1b203f2b7a86927cde35f8a39"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BleGattServerMenu</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">reference_wrapper</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">espp</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4espp13BleGattServerE" title="espp::BleGattServer"><span class="n"><span class="pre">BleGattServer</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">server</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp17BleGattServerMenu17BleGattServerMenuENSt17reference_wrapperIN4espp13BleGattServerEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Construct a new <a class="reference internal" href="#classespp_1_1BleGattServerMenu"><span class="std std-ref">BleGattServerMenu</span></a>. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>server</strong> – The <a class="reference internal" href="#classespp_1_1BleGattServer"><span class="std std-ref">BleGattServer</span></a> to use. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4espp17BleGattServerMenu3getENSt11string_viewENSt11string_viewE">
<span id="_CPPv3N4espp17BleGattServerMenu3getENSt11string_viewENSt11string_viewE"></span><span id="_CPPv2N4espp17BleGattServerMenu3getENSt11string_viewENSt11string_viewE"></span><span id="espp::BleGattServerMenu::get__std::string_view.std::string_view"></span><span class="target" id="classespp_1_1BleGattServerMenu_1ae5dfabb551bd579cc133066412afd45f"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">unique_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">cli</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Menu</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string_view</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">name</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="s"><span class="pre">&quot;ble&quot;</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string_view</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">description</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="s"><span class="pre">&quot;BLE</span> <span class="pre">GATT</span> <span class="pre">Server</span> <span class="pre">menu&quot;</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4espp17BleGattServerMenu3getENSt11string_viewENSt11string_viewE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the <a class="reference internal" href="#classespp_1_1BleGattServer"><span class="std std-ref">BleGattServer</span></a> menu. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The name of the menu. </p></li>
<li><p><strong>description</strong> – The description of the menu. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A unique pointer to the <a class="reference internal" href="#classespp_1_1BleGattServer"><span class="std std-ref">BleGattServer</span></a> menu that you can use to add to a CLI. </p>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="battery_service.html" class="btn btn-neutral float-left" title="Battery Service" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ble_gatt_server_example.html" class="btn btn-neutral float-right" title="BLE GATT Server Example" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022 - 2026, William Emfinger.</p>
  </div>

  <ul class="footer">
        <li>
	    
            
            Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/espressif/sphinx_idf_theme">theme</a>  based on <a href="https://github.com/readthedocs/sphinx_rtd_theme">Read the Docs Sphinx Theme</a>.
         </li>

  </ul> 

</footer>
        </div>
      </div>
    </section>
  </div>

  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>